import unittest
import time
from random import randint
from math import log

from gauss import GaussianInteger
from params import *
from params_dgt import *

def poly_mul(x, y):
    # n = 2^7*6 = 768

    x_ntt = dgt_6(dgt_2(x))
    y_ntt = dgt_6(dgt_2(y))

    mul = [(x*y) for x,y in zip(x_ntt, y_ntt)]

    z = idgt_2(idgt_6(mul))

    return z

def dgt_2(x):
    # N = 6*(2**7) = 768
    output = []

    # For each block of 2**7 coefficients
    for i in range(6):
        
        block = []

        # Extract the i-th block
        for j in range(N):
            block.append(x[N*i+j])

        # Fold the signal: for now on, the block has size N//2
        block = [GaussianInteger(x, y) for x, y in zip(block[:N//2], block[N//2:])]

        # Twist the folded signal
        block = [block[j]*nthroots[j] for j in range(N//2)]

        # Compute the DGT for each of them
        block = dgt_gentlemansande(block)

        # Save dgt(block) in the output
        for j in range(N//2):
            output.append(block[j])            

    return output   

def idgt_2(x_dgt):    
    
    output = []

    # For each block of N//2 Gaussian integers
    for i in range(6):
        
        block = []

        # Extract the block of Gaussian integers
        for j in range(N//2):
            block.append(x_dgt[(N//2)*i+j])

        # Compute its counterpart in the ring defined by x^{2**7}+1
        x = idgt_gentlemansande(block)

        # Remove twisting factors
        x = [x[j]*invNthroots[j] for j in range(N//2)]

        # Unfold the output and save the idgt(block) into its correspondent place in the output
        for j in range(N//2):
            output.append(x[j].re)

        for j in range(N//2):
            output.append(x[j].imag)

    return output 

def dgt_6(X):
    
    x = list(X)

    # For each of the 2**6 blocks of Gaussian integers
    for j in range(N//2):        
        
        x_tilde = []
        
        # Extract 6 elements
        for i in range(6):
            x_tilde.append(x[(N//2)*i+j])

        x_tilde = [x_tilde[i]*theta[i] for i in range(6)] # theta transformation

        # mu transformations
        s0 = x_tilde[0] + x_tilde[3]
        s1 = x_tilde[1] + x_tilde[4]
        s2 = x_tilde[2] + x_tilde[5]
        s3 = (s1 - s2) * theta[3] # zeta = theta^3

        x[(N//2)*0+j] = (s0 + s1 + s2) 
        x[(N//2)*2+j] = (s0 - s2 + s3) 
        x[(N//2)*4+j] = (s0 - s3 - s1)

        s0 = x_tilde[0] + x_tilde[3] * theta[3]
        s1 = x_tilde[1] * theta[1] + x_tilde[4] * theta[4]
        s2 = x_tilde[2] * theta[2] + x_tilde[5] * theta[5]
        s3 = (s1 - s2) * theta[3]

        x[(N//2)*1+j] = (s0 + s1 + s2)
        x[(N//2)*3+j] = (s0 - s2 + s3) 
        x[(N//2)*5+j] = (s0 - s3 - s1)

    return x

def idgt_6(X):
    x = list(X)

    for j in range(N//2):        
        x_tilde = []
        
        for i in range(6):
            x_tilde.append(x[(N//2)*i+j])

        # mu_death
        t0 = (x_tilde[2] - x_tilde[4]) * theta[3]
        t1 = (x_tilde[3] - x_tilde[5]) * theta[3]

        s0 = x_tilde[0] + x_tilde[2] + x_tilde[4]
        s1 = x_tilde[1] + x_tilde[3] + x_tilde[5]

        x[(N//2)*0+j] = s0 - s1 * theta[6]
        x[(N//2)*3+j] = s0 - s1

        s0 = x_tilde[0] - x_tilde[2] - t0
        s1 = x_tilde[1] - x_tilde[3] - t1

        x[(N//2)*1+j] = s0 - s1 * theta[5]
        x[(N//2)*4+j] = s0 - s1 * theta[8]

        s0 = x_tilde[0] - x_tilde[4] + t0
        s1 = x_tilde[1] - x_tilde[5] + t1

        x[(N//2)*2+j] = s0 - s1 * theta[4]
        x[(N//2)*5+j] = s0 - s1 * theta[7]

        #psi_death
        x[(N//2)*0+j] = (x[(N//2)*0+j] * one_minus_zeta_by_nine)
        x[(N//2)*1+j] = (x[(N//2)*1+j] * one_minus_zeta_by_nine * theta_inv[1]) 
        x[(N//2)*2+j] = (x[(N//2)*2+j] * one_minus_zeta_by_nine * theta_inv[2])
        
        x[(N//2)*3+j] = (x[(N//2)*3+j] * zeta_minus_one_by_nine * theta[3])
        x[(N//2)*4+j] = (x[(N//2)*4+j] * zeta_minus_one_by_nine * theta[2])
        x[(N//2)*5+j] = (x[(N//2)*5+j] * zeta_minus_one_by_nine * theta[1])      

    return x

## In-place DGT via Gentleman-Sande
def dgt_gentlemansande(x):   
    k = len(x)
    X = list(x)
    
    for stride in range(int(log(k,2))):        
        m = k // (2<<stride)

        for l in range(k // 2):
            j = l//(k//(2*m))
            a = gj_powers[j][stride]
            i = j + (l % (k//(2*m)))*2*m
        
            xi = X[i]
            xim = X[i + m]
            X[i] = xi + xim
            X[i + m] = a * (xi - xim)

    return X    

## In-place IDGT via Cooley-Tukey
def idgt_gentlemansande(x):
    k = len(x)
    X = list(x)
    
    m = 1
    for stride in range(int(log(k,2))):
        for l in range(k // 2):
            j = l//(k//(2*m))            
            a = invgj_powers[j][stride]            
            i = j + (l % (k//(2*m)))*2*m
            xi = X[i]
            xim = X[i + m]

            X[i] = xi + a * xim
            X[i + m] = xi - a * xim
        m = 2 * m

    return [v*invofkmodp for v in X]

class TestDGTGentlemansande(unittest.TestCase):

    def test_poly_mul(self):
        print("\nPolynomial multiplication in a non-power of two cyclotomic ring of integers")
        
        a = [5768276, 2239079, 5619164, 1232355, 3825014, 4747737, 7598606, 7799814, 5197845, 6161692, 8257231, 7872500, 1025459, 6189367, 2842366, 3604869, 5808152, 1716428, 339300, 4795900, 7391933, 8330317, 606867, 7438771, 7041477, 2363785, 2026047, 6914497, 2497022, 1056036, 5525328, 8077498, 5890670, 989674, 3195202, 8188308, 7208102, 5169426, 401691, 6855411, 564958, 8162695, 3267650, 4347657, 3872291, 735900, 2816286, 1405416, 2155311, 4274282, 1768124, 4108188, 657197, 1382838, 3356966, 6843580, 1124883, 1132412, 5404449, 3688123, 544798, 7980219, 4886874, 5369409, 2448831, 6602323, 7943594, 767138, 2031864, 2249582, 6677611, 1328931, 6592468, 3607319, 7750071, 405663, 6978376, 5439802, 1480663, 4301491, 3790833, 5649621, 7273368, 1636162, 3035098, 5597778, 1608708, 85432, 7048187, 5828118, 3777717, 8109102, 3119154, 3929931, 3738054, 7213493, 3731300, 7707447, 5653139, 7134214, 717522, 1309448, 1731258, 446458, 1573404, 7565672, 1549881, 8283313, 1016644, 5310844, 2221088, 5326118, 2286758, 4730476, 7234433, 1982175, 8936, 4194361, 1877573, 4837678, 6216575, 6913898, 4585551, 6179626, 6500532, 3616342, 3060003, 4710552, 2514330, 110907, 442480, 5711563, 5610919, 4242937, 1537530, 6902386, 6758685, 4900784, 4423862, 7298735, 941780, 6852582, 4140882, 2051115, 1052173, 6133825, 8393640, 5288421, 8320368, 3241606, 3608109, 5395325, 8059289, 2210611, 6326588, 7424958, 7323975, 4912145, 515440, 6255040, 315830, 686037, 4755843, 3587301, 4551352, 6836222, 6219231, 7015502, 1904068, 7778104, 5980515, 4814201, 5695822, 1122200, 7179454, 7625941, 6205272, 3837122, 2714228, 3025590, 3121892, 1721281, 1112314, 3747760, 1155024, 151834, 7212836, 4973018, 1231574, 1744161, 6920134, 4712738, 4885691, 4199836, 1230907, 5687200, 4166341, 916558, 241962, 7368985, 7533676, 6075705, 6692349, 913877, 3624520, 995877, 1084323, 3010847, 6415269, 6940610, 2202238, 5244680, 515735, 5367062, 3794992, 1567586, 7649426, 5952308, 7277579, 2684450, 8300490, 1598420, 741722, 3101191, 3922638, 3637073, 3697747, 6900473, 676894, 2600175, 1051710, 2682389, 5839146, 7644891, 6373326, 6614457, 5330668, 6598042, 6560585, 6866218, 8253931, 2509031, 838106, 1088347, 3984335, 5953574, 6636709, 107418, 3180473, 4471250, 7082677, 4387650, 3843263, 4132093, 7489838, 7234480, 7464630, 7129302, 6101673, 3756371, 8351033, 2053556, 704080, 4370980, 6992782, 8232248, 493666, 3519691, 3733998, 6228471, 5944394, 3560105, 6325505, 2784067, 6960240, 3346601, 7911210, 339581, 1031849, 1496447, 3012058, 5652596, 4947828, 8287182, 575282, 4703175, 7153955, 5247273, 3188469, 111387, 5081901, 2580200, 7013407, 1492978, 6027225, 7771275, 1094050, 3388272, 1637736, 1351841, 7087231, 3566349, 6713939, 582678, 4858652, 8244856, 4559652, 2772769, 2191204, 5671555, 5174957, 7012131, 4378408, 1624457, 3668973, 2828587, 7997753, 5113878, 1139309, 1343925, 5842308, 3243945, 5140318, 6289763, 2921386, 7611033, 1576994, 5017491, 5209249, 6603088, 6765701, 1374690, 5114707, 1961366, 4899028, 7478624, 2036464, 3954181, 6192483, 4640431, 954843, 6143015, 2908988, 7787454, 5450260, 6159131, 5378176, 4169534, 3219597, 8201093, 4459895, 433173, 2356265, 7426535, 3855302, 6690599, 1278898, 4634438, 675109, 4573860, 2053033, 4145181, 2311268, 5758668, 1811108, 2420511, 651765, 2824247, 5710034, 1516171, 6969772, 2328854, 6713852, 3497901, 2413708, 2824719, 1267761, 5429504, 5580232, 7544147, 364419, 3601028, 7359740, 4915546, 445400, 6278353, 5077728, 2743890, 4570862, 1996390, 6709545, 8169292, 3380313, 3345911, 5704568, 469832, 7508927, 5031431, 5971623, 7482026, 5702206, 6702049, 1853353, 5878925, 1229722, 8243451, 5704739, 1857038, 8205300, 6717493, 2558366, 2505422, 3270285, 1670424, 8314694, 5566897, 2671407, 2327615, 846491, 6060974, 7167238, 1024702, 3539230, 2600940, 6109192, 4368373, 332513, 3791249, 4770033, 3807602, 749595, 4966516, 1149026, 294689, 1684977, 4159616, 5664792, 1950491, 6702026, 1126922, 4553266, 4785743, 2924135, 3238716, 8043927, 4484129, 5727743, 8055260, 5010370, 8163934, 212871, 974681, 8067158, 6674520, 3943987, 5725228, 1887342, 397034, 6655096, 6707980, 5988754, 6187651, 8380590, 6173103, 3410999, 367198, 4277301, 5576102, 6977225, 4553904, 3878331, 5728724, 2318113, 2234271, 2631567, 694351, 4067998, 445424, 6897524, 829966, 2961098, 8088130, 5933551, 5464378, 1619661, 4447866, 382023, 4843554, 4051570, 1786428, 2969128, 443400, 3421712, 7320352, 3629292, 2505990, 6157605, 843564, 6832037, 6188760, 7124971, 6964187, 3252431, 7182612, 821728, 2134150, 8341253, 3936659, 4556649, 2437404, 1861548, 2830853, 409295, 1949285, 7247047, 1370861, 5346213, 7243919, 4226226, 5394260, 4345207, 3167791, 1262864, 3262573, 2259566, 4934445, 6218076, 3071674, 5669397, 6837381, 4835342, 7994612, 2146088, 4509374, 3141173, 7684241, 6093573, 4055959, 7799463, 5067957, 7619449, 4376210, 1180072, 8167157, 5974669, 396159, 1312474, 546474, 963024, 6993295, 3729216, 4427114, 3403060, 5355080, 8264174, 750932, 3289508, 833622, 7743614, 6583381, 805416, 6602809, 7981903, 421244, 3393832, 6538055, 1153738, 7475767, 2321642, 136090, 263666, 962593, 2140499, 7132418, 3984971, 277982, 7269415, 7688888, 251830, 1855873, 6633986, 582493, 446384, 96334, 926002, 4527039, 4788946, 2969511, 5553762, 1364995, 3995153, 6111522, 7614200, 3880778, 6565115, 4104044, 4877960, 3554581, 3107422, 6214612, 526030, 1318501, 6434806, 7559139, 8387478, 5567277, 1630974, 4346435, 6047118, 1852229, 1729443, 4112401, 210886, 5773763, 1992248, 3455383, 7778080, 6671350, 3990189, 7510738, 5984734, 6477071, 158649, 6964374, 573059, 7406173, 1470406, 6523649, 8400546, 7643921, 5368338, 8278994, 7483765, 5394416, 3042260, 3822334, 32397, 2119482, 2353688, 5500684, 2277478, 4928406, 5042683, 6309127, 7340479, 7805885, 4281837, 2493376, 6396836, 910043, 8290324, 6886197, 6973309, 5468270, 4892331, 703507, 2643682, 6906995, 1887889, 4969767, 7899141, 1694215, 3872034, 962103, 8287512, 3144236, 5888384, 1934263, 97493, 3552852, 5029221, 1264998, 3661578, 6888561, 3987243, 1666707, 3465943, 5794775, 399671, 1032365, 5453801, 4759570, 6856532, 6249973, 3783175, 206069, 939797, 4384011, 465081, 6585143, 1505481, 116995, 5860542, 1515683, 1871321, 8051803, 2116643, 6360375, 7605110, 7672562, 1407549, 5593232, 5768270, 2628311, 5664493, 5171386, 3486971, 2250893, 7758730, 2852030, 4515040, 1753536, 3306701, 8264707, 5957273, 5533000, 8033571, 1582635, 909931, 302694, 3615229, 6176772, 5146434, 7964848, 1374941, 5374408, 8356788, 6791188, 3056938, 5119171, 5681553, 8053981, 2357741, 7249464, 2189677, 8061944, 5250947, 5261008, 1606586, 5572363, 8315744, 4669608, 2964882, 949758, 1513801, 545891, 6913877, 6089869, 60106, 290032, 1246618, 5742531, 2563308, 1895232, 8004468, 3557571, 4014028, 2418422, 8175472, 246368, 2560907, 2727425, 6189106, 816805, 6902429, 2767355, 3422045, 5061449]
        b = [8, 5, 0, 8404989, 8404980, 8404983, 1, 8404982, 8404983, 8404978, 1, 0, 0, 8404983, 12, 8404982, 4, 8404991, 8404983, 8404990, 0, 8404976, 8404988, 8404985, 5, 8404980, 8404992, 8404977, 8404990, 8404983, 10, 8404990, 10, 8404976, 5, 8404991, 8404985, 4, 3, 12, 8404989, 11, 8404977, 10, 8404989, 11, 8404978, 8404986, 8404990, 5, 8404985, 8404981, 2, 8404984, 27, 5, 8404974, 8404981, 8404968, 8404990, 8, 8404992, 16, 8404978, 8404992, 8404990, 0, 8404978, 0, 8404992, 18, 0, 15, 8404991, 0, 11, 8404989, 8404979, 18, 2, 8404982, 8404986, 8404990, 8404984, 4, 2, 14, 8404974, 6, 8, 8404990, 8404984, 8404992, 8404983, 8404981, 6, 8404988, 12, 6, 6, 18, 8404992, 3, 8404989, 13, 8404982, 11, 8404988, 2, 15, 0, 8, 5, 8404990, 25, 8404984, 8404986, 8404983, 0, 2, 9, 3, 8404990, 8404981, 12, 9, 8404986, 8404983, 8404985, 0, 3, 8404979, 8404977, 4, 4, 8404989, 4, 8404989, 8404983, 9, 3, 8404989, 11, 1, 10, 13, 8404992, 4, 3, 7, 8404991, 8404982, 13, 0, 8404985, 6, 2, 11, 4, 8404988, 11, 8404992, 8404981, 5, 8404963, 6, 8404987, 8404961, 8404972, 8404992, 8404988, 8404984, 8404989, 10, 5, 8404971, 1, 8, 8404992, 8404975, 1, 8404987, 4, 11, 8404985, 8404986, 6, 3, 8404987, 6, 2, 8404984, 6, 8404982, 8404989, 8404991, 9, 8404981, 5, 8404992, 5, 8404974, 0, 8404989, 4, 1, 7, 8404980, 8404979, 1, 2, 8404986, 8404988, 8404984, 7, 8, 8404983, 6, 3, 0, 8404980, 6, 4, 9, 8404985, 8404985, 12, 7, 1, 4, 8404984, 14, 1, 8404991, 14, 8404989, 14, 8404988, 5, 15, 8404985, 3, 4, 8404985, 8404989, 8404988, 8404974, 8404978, 6, 13, 9, 8404979, 4, 2, 4, 8404980, 6, 8, 8404975, 8404990, 8404984, 7, 18, 4, 7, 11, 8404986, 21, 16, 8404989, 0, 8404987, 5, 8404992, 2, 14, 8404990, 0, 0, 8404990, 1, 8404978, 7, 10, 8404988, 3, 8404983, 0, 8404987, 8404983, 8404983, 8, 8404992, 8404992, 21, 8404983, 8404981, 22, 8404981, 6, 8404977, 2, 8404986, 2, 4, 3, 7, 2, 7, 7, 8404989, 8404991, 8, 0, 4, 8404983, 9, 8404985, 8404992, 1, 8404984, 8404988, 8404978, 1, 8, 8404990, 8404989, 1, 8404984, 8404987, 8404981, 6, 8404987, 15, 8404992, 18, 11, 8404985, 8404987, 1, 17, 8404985, 8404989, 8404982, 11, 2, 8404983, 8, 8404990, 8404972, 3, 1, 4, 5, 8404989, 9, 8, 8, 8404991, 7, 8404992, 8404982, 8404989, 17, 8404982, 5, 8404992, 7, 8404981, 8404989, 8404990, 1, 8404987, 8404986, 8404992, 8404982, 5, 8404992, 7, 3, 8404990, 8, 7, 8404987, 3, 17, 11, 8404982, 8404991, 14, 8, 8404984, 2, 15, 8404985, 8, 15, 18, 9, 8404991, 8404991, 8404981, 8404990, 8404979, 8404987, 9, 2, 6, 4, 22, 8, 8404983, 3, 0, 11, 3, 8404988, 8404983, 1, 8404991, 3, 7, 9, 8404987, 8404980, 8404970, 8404984, 6, 12, 12, 8404977, 8404980, 8404985, 0, 8404979, 4, 8404990, 8, 0, 8404992, 8404992, 8404966, 5, 8404987, 8, 8404988, 8404986, 8404982, 14, 6, 8404988, 9, 8, 8404991, 5, 6, 8404987, 2, 4, 13, 0, 8, 8404979, 8404988, 8404989, 1, 8, 1, 18, 5, 8404989, 0, 8404986, 8404980, 8404986, 7, 8404992, 6, 8404987, 8404977, 12, 17, 3, 13, 8404978, 22, 27, 8404991, 2, 6, 9, 8, 8404980, 3, 3, 8404991, 10, 8404992, 8404986, 10, 14, 6, 0, 11, 16, 12, 7, 9, 8404978, 8404982, 8404981, 8404992, 8404992, 8404988, 14, 15, 8404987, 7, 8, 8404984, 8404983, 8404987, 17, 7, 4, 3, 8404985, 0, 8404992, 10, 6, 1, 8404989, 8404980, 8404975, 8404990, 0, 21, 8404984, 8404989, 15, 3, 8404985, 6, 8404987, 18, 8404992, 17, 8404980, 1, 5, 2, 1, 13, 8404989, 8404988, 3, 8404991, 8404986, 16, 0, 6, 8404990, 12, 12, 2, 8404986, 8404978, 8404982, 8404970, 8404984, 4, 12, 1, 8404986, 8404991, 8404985, 8404981, 5, 8404978, 7, 32, 8404973, 8404982, 21, 8404983, 4, 21, 11, 3, 8404985, 1, 8404982, 1, 6, 3, 8404986, 8404984, 3, 7, 10, 8404992, 15, 1, 8404990, 4, 8404990, 8404979, 2, 5, 8404985, 8, 8404976, 8404987, 12, 8404987, 15, 8404992, 11, 8404991, 2, 8404988, 8404977, 3, 8404982, 6, 18, 8404988, 1, 8404972, 8404989, 8404980, 8404988, 8404984, 8404988, 8404990, 0, 8404987, 8404990, 8404989, 8404990, 8404987, 8404990, 8404991, 16, 8404991, 1, 4, 8404983, 5, 8404986, 10, 8, 12, 8404968, 4, 2, 15, 8404986, 9, 8404984, 8404988, 0, 5, 8404990, 8404984, 8404990, 0, 5, 8404989, 8404991, 12, 2, 8404985, 8404980, 8404982, 8404989, 4, 24, 4, 8404984, 0, 8404991, 1, 8404992, 8404989, 3, 5, 8404981, 0, 8404985, 8, 1, 6, 0, 8404991, 15, 7, 3, 8, 0, 8404987, 6, 8404985, 4, 3, 6, 8404978, 8404992, 8404982, 1, 8404981, 8404988, 1, 8404989, 8404988, 15, 8404980, 8404991, 16, 8404981, 8404991, 8404986, 8404992, 5, 8, 8, 8, 7, 8404991, 8404991, 2, 8404981, 11, 8404987, 8404984, 4, 7, 8404989, 8404985, 18, 18, 8404989, 7, 6, 1, 8404980, 6, 9, 8404990, 8404983, 0, 2, 7, 13, 8, 16, 0, 8404975, 8404983, 8404983, 8404976, 1, 1, 8404989, 8404990, 9, 8404977]
        ab = [667065, 66870, 5398544, 2736325, 5324352, 2469094, 7407562, 2572594, 7577068, 7431086, 2855881, 520344, 1311200, 1346729, 4703925, 2027585, 4737103, 1355406, 6589281, 5145022, 5971556, 2022357, 7454495, 2038208, 600855, 3508504, 6197982, 1726536, 3655563, 14088, 1668902, 7175417, 6161750, 5315280, 700848, 1201977, 3359382, 1680993, 2159135, 137945, 8307125, 1032395, 4932566, 3662707, 2411906, 5665752, 117151, 1244104, 3268655, 7831451, 4576534, 6741302, 6356735, 5969077, 2180953, 1983741, 545963, 2348778, 7022296, 4957040, 4440352, 1044782, 5389164, 6050779, 3090698, 125295, 151209, 1502241, 8348051, 3421623, 3112919, 5056398, 8243286, 1215795, 4127114, 5211873, 605768, 1589216, 2386825, 7624905, 262111, 5397525, 794948, 1199535, 2918435, 7499131, 2056392, 8184674, 3900877, 6757714, 214415, 6387793, 6584267, 6660546, 7387640, 6863762, 5611084, 1862335, 1421306, 5349470, 994972, 6241295, 875947, 6624569, 5892703, 3530212, 1225084, 3542635, 2450806, 2300798, 6980210, 6890763, 6465702, 390169, 1121706, 4946679, 1607444, 4385361, 8177794, 2916788, 2128678, 1840920, 1526239, 5678095, 7417466, 4089703, 6868920, 6512911, 5775164, 7034917, 3360787, 6364326, 1172470, 2729080, 5829587, 5925409, 323780, 4765740, 8227385, 436990, 5441804, 6670290, 4936488, 7371921, 1069938, 3295355, 5710684, 2889224, 5981626, 5848377, 8214342, 528458, 5756634, 7656105, 6861085, 7445093, 7794233, 234582, 2972765, 2567940, 707040, 1213884, 1159356, 7851145, 5096638, 1186159, 6723859, 232646, 2617986, 5180429, 175340, 2025655, 4014292, 4714441, 3697764, 7620570, 6483729, 7780839, 6797192, 8252579, 4958246, 823453, 6113261, 5903150, 219731, 772857, 579772, 6054565, 4868683, 2265431, 3015468, 1867085, 5695817, 940725, 3534312, 7522238, 8044613, 5497452, 7377462, 3469763, 3158449, 419495, 5653282, 4895201, 2704575, 4775756, 2097197, 596873, 4893115, 4810787, 223144, 3103879, 3791410, 6982131, 7205223, 105980, 8256932, 7399594, 712483, 5590214, 1865887, 2615619, 2946433, 814414, 7515103, 4754013, 7936899, 2228610, 6647978, 4926964, 2057516, 7517997, 5897094, 1976723, 7870256, 5237731, 4363645, 8051110, 5630979, 6626573, 3694018, 4905348, 3460317, 1766545, 5421830, 7336407, 5211706, 1937205, 4771180, 5533716, 5434381, 5457789, 5258921, 5799483, 7097659, 7975366, 5240990, 2909545, 943905, 742367, 5711899, 3532933, 3945329, 6612335, 1838692, 2753781, 7359916, 8360841, 992800, 6643796, 2805962, 7440666, 924114, 4687877, 6358639, 6541247, 2125150, 6042533, 8399992, 6549520, 433294, 6100860, 1458411, 3541642, 3113656, 7791906, 2961159, 5688207, 5497771, 7002970, 5639165, 5547949, 808991, 5550642, 1621653, 7637070, 3924704, 1278107, 8137547, 4926002, 1288632, 6220983, 1633196, 1006975, 6131161, 6490395, 7145665, 94169, 2306364, 7599075, 2657144, 4593461, 5932621, 1957640, 7483336, 5684182, 51566, 2403049, 6042302, 2682504, 3974914, 3788092, 4424471, 1362118, 5587597, 3901710, 5117755, 5077894, 3222104, 7527944, 28215, 4296747, 1580618, 3180977, 2133861, 730280, 4717880, 7938382, 3518219, 5273761, 6052085, 763553, 1386888, 1760260, 6125529, 3328550, 7877493, 1586258, 3351346, 4525361, 3734913, 2329179, 7114799, 7342382, 7330859, 7610097, 4531612, 1032980, 8126371, 359288, 7708077, 7528096, 6647063, 5746447, 742618, 1061774, 473130, 7349548, 3540791, 383159, 5695069, 5698622, 7451733, 938147, 6627376, 3818092, 2607210, 2312495, 1381310, 7443015, 1615018, 5766772, 6183625, 5066765, 1132119, 3062466, 1007567, 3000261, 2054240, 3639197, 1529835, 3237003, 7340867, 301512, 5224125, 3749208, 7314514, 1033707, 4949111, 6492419, 3641641, 5654184, 797075, 7841212, 8056744, 4890389, 1908992, 8061827, 5423753, 7679686, 7581050, 6906062, 4858132, 8282261, 3710945, 1759363, 7983820, 4304037, 3741148, 6296167, 5080186, 7562219, 3184539, 6338579, 5118168, 7542637, 925115, 5100996, 8355836, 2895509, 287956, 2928898, 5317458, 5794219, 2499599, 5761070, 6559911, 5296661, 2611119, 4995427, 4171839, 6138947, 6644228, 1198292, 1956832, 1829864, 3847321, 1205580, 7074645, 6192839, 6349447, 6862962, 6430514, 5365614, 7133469, 203713, 8234091, 1380584, 546503, 3268371, 2056725, 184674, 2974406, 3086350, 144401, 5827991, 3843868, 2619075, 3114365, 6049954, 6827768, 2403336, 6448679, 1549006, 6161980, 4141644, 8040391, 557219, 5022469, 2892528, 3772835, 4534316, 3789993, 5880545, 3448326, 4528410, 2353500, 6862751, 6380857, 5172955, 7909549, 1343982, 7276466, 1931293, 4593503, 1563098, 6227779, 2554590, 1592065, 1348376, 4702583, 6683290, 7079744, 7769995, 7889084, 8013812, 1233193, 3825099, 302173, 1748269, 5848625, 3310741, 3419192, 2902705, 7035020, 4121297, 481943, 8296604, 4831321, 2522034, 1270942, 994297, 4688512, 4787458, 4081660, 7289642, 1201072, 5551946, 7153798, 4112521, 6524179, 2861759, 7158000, 7586653, 4905074, 5546413, 4972734, 27211, 8267913, 6108473, 5746861, 3951444, 7704959, 6065087, 3548570, 8266969, 5738456, 3400195, 4311036, 4815521, 1545193, 447871, 3982719, 7316940, 7675261, 8361468, 3795298, 828987, 5688880, 6101648, 6660853, 7433987, 1026324, 8222017, 7359498, 3377379, 3523914, 6699537, 1794532, 3721066, 6170541, 157291, 2097962, 5347569, 7348093, 3642233, 6137547, 7430375, 3567687, 750740, 279636, 7295445, 3837854, 6019705, 3237679, 2889966, 2650985, 3076448, 466524, 5398266, 4934587, 180131, 8085649, 3876244, 6880290, 4324886, 7339848, 7823150, 5174270, 6595508, 3414428, 2760075, 4102014, 3181910, 3786942, 4844389, 2928748, 5242342, 2946118, 1083726, 7413408, 4839570, 5690154, 406266, 5273537, 7609924, 4268565, 3342794, 4136275, 4994456, 5114576, 1445903, 6560323, 3992457, 5685389, 6020943, 4082377, 4898781, 5043805, 3165693, 1527489, 7320067, 686425, 8241437, 7307822, 5282179, 6578142, 3625764, 4428013, 5840314, 3306731, 6597235, 3630169, 2898629, 6606810, 1647443, 6723684, 938763, 7639876, 6705716, 5994079, 8201772, 548523, 6477650, 1991566, 4454867, 7594805, 4617213, 4683471, 134, 6740565, 4559505, 8057325, 7281736, 8008059, 7342194, 2464922, 2506659, 7968992, 7701688, 1084416, 6970918, 5725318, 587436, 5882553, 175251, 2092390, 6940864, 1314400, 305214, 7944808, 2569617, 2698915, 7862219, 371988, 6686769, 3405277, 1254187, 2616944, 5890671, 4326175, 1656221, 1847911, 4842755, 6800605, 1408781, 2618961, 1962201, 5047340, 2654825, 5946718, 203949, 1508746, 682764, 2145115, 733952, 3430602, 2390724, 2703347, 2529058, 3725539, 1380718, 2084618, 8016465, 2705723, 5703105, 2067, 2214359, 731903, 7191017, 1749070, 3673768, 1863921, 1956462, 3317456, 7487213, 1730816, 466476, 1988991, 21266, 6234431, 3035980, 1003746, 5095029, 1716908, 8254969, 7616434, 2520952, 2073254, 2847413, 5560534, 7554641, 3338176, 2929678, 5532296, 4506589, 1520652, 5817539, 6921727, 2194385, 7980350, 3659329, 7407698, 5026058, 5428513, 3917517, 2107376, 5267917, 7102810, 2040057, 2130314, 6464567, 6066938, 1326032, 3059892, 175919, 7355109, 5196081]
        
        start_time = time.time()
        c = poly_mul(a, b)
        end_time = time.time()

        print(c)

        print("----------", end_time - start_time, "s. ----------")

        assert(c == ab)

if __name__ == '__main__':
    unittest.main()