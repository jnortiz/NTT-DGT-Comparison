import unittest
import time
from random import randint
from math import log

from gauss import GaussianInteger
from params import *
from params_dgt import *

def poly_mul(x, y):
    # n = 2^7*6 = 768

    x_ntt = dgt_6(dgt_2(x))
    y_ntt = dgt_6(dgt_2(y))

    mul = [(x*y) for x,y in zip(x_ntt, y_ntt)]

    z = idgt_2(idgt_6(mul))

    return z

def dgt_2(x):
    # N = 6*(2**7) = 768
    output = []

    # For each block of 2**7 coefficients
    for i in range(6):
        
        block = []

        # Extract the i-th block
        for j in range(2**7):
            block.append(x[(2**7)*i+j])

        # Fold the signal: for now on, the block has size 2**6
        block = [GaussianInteger(x, y) for x, y in zip(block[:N//2], block[N//2:])]

        # Twist the folded signal
        block = [block[j]*nthroots[j] for j in range(N//2)]

        # Compute the DGT for each of them
        block = dgt_gentlemansande(block)

        # Save dgt(block) in the output
        for j in range(2**6):
            output.append(block[j])            

    return output   

def idgt_2(x_dgt):    
    
    output = []

    # For each block of 2**6 Gaussian integers
    for i in range(6):
        
        block = []

        # Extract the block of Gaussian integers
        for j in range(N//2):
            block.append(x_dgt[(N//2)*i+j])

        # Compute its counterpart in the ring defined by x^{2**7}+1
        x = idgt_gentlemansande(block)

        # Remove twisting factors
        x = [x[j]*invNthroots[j] for j in range(N//2)]

        # Unfold the output and save the idgt(block) into its correspondent place in the output
        for j in range(N//2):
            output.append(x[j].re)

        for j in range(N//2):
            output.append(x[j].imag)

    return output 

def dgt_6(X):
    
    x = list(X)

    # For each of the 2**6 blocks of Gaussian integers
    for j in range(N//2):        
        
        x_tilde = []
        
        # Extract 6 elements
        for i in range(6):
            x_tilde.append(x[(N//2)*i+j])

        x_tilde = [x_tilde[i]*theta[i] for i in range(6)] # theta transformation

        # mu transformations
        s0 = x_tilde[0] + x_tilde[3]
        s1 = x_tilde[1] + x_tilde[4]
        s2 = x_tilde[2] + x_tilde[5]
        s3 = (s1 - s2) * theta[3] # zeta = theta^3

        x[(N//2)*0+j] = (s0 + s1 + s2) 
        x[(N//2)*2+j] = (s0 - s2 + s3) 
        x[(N//2)*4+j] = (s0 - s3 - s1)

        s0 = x_tilde[0] + x_tilde[3] * theta[3]
        s1 = x_tilde[1] * theta[1] + x_tilde[4] * theta[4]
        s2 = x_tilde[2] * theta[2] + x_tilde[5] * theta[5]
        s3 = (s1 - s2) * theta[3]

        x[(N//2)*1+j] = (s0 + s1 + s2)
        x[(N//2)*3+j] = (s0 - s2 + s3) 
        x[(N//2)*5+j] = (s0 - s3 - s1)

    return x

def idgt_6(X):
    x = list(X)

    for j in range(N//2):        
        x_tilde = []
        
        for i in range(6):
            x_tilde.append(x[(N//2)*i+j])

        # mu_death
        t0 = (x_tilde[2] - x_tilde[4]) * theta[3]
        t1 = (x_tilde[3] - x_tilde[5]) * theta[3]

        s0 = x_tilde[0] + x_tilde[2] + x_tilde[4]
        s1 = x_tilde[1] + x_tilde[3] + x_tilde[5]

        x[(N//2)*0+j] = s0 - s1 * theta[6]
        x[(N//2)*3+j] = s0 - s1

        s0 = x_tilde[0] - x_tilde[2] - t0
        s1 = x_tilde[1] - x_tilde[3] - t1

        x[(N//2)*1+j] = s0 - s1 * theta[5]
        x[(N//2)*4+j] = s0 - s1 * theta[8]

        s0 = x_tilde[0] - x_tilde[4] + t0
        s1 = x_tilde[1] - x_tilde[5] + t1

        x[(N//2)*2+j] = s0 - s1 * theta[4]
        x[(N//2)*5+j] = s0 - s1 * theta[7]

        #psi_death
        x[(N//2)*0+j] = (x[(N//2)*0+j] * one_minus_zeta_by_nine)
        x[(N//2)*1+j] = (x[(N//2)*1+j] * one_minus_zeta_by_nine * theta_inv[1]) 
        x[(N//2)*2+j] = (x[(N//2)*2+j] * one_minus_zeta_by_nine * theta_inv[2])
        
        x[(N//2)*3+j] = (x[(N//2)*3+j] * zeta_minus_one_by_nine * theta[3])
        x[(N//2)*4+j] = (x[(N//2)*4+j] * zeta_minus_one_by_nine * theta[2])
        x[(N//2)*5+j] = (x[(N//2)*5+j] * zeta_minus_one_by_nine * theta[1])      

    return x

## In-place DGT via Gentleman-Sande
def dgt_gentlemansande(x):   
    k = len(x)
    X = list(x)
    
    for stride in range(int(log(k,2))):        
        m = k // (2<<stride)

        for l in range(k // 2):
            j = l//(k//(2*m))
            a = gj_powers[j][stride]
            i = j + (l % (k//(2*m)))*2*m
        
            xi = X[i]
            xim = X[i + m]
            X[i] = xi + xim
            X[i + m] = a * (xi - xim)

    return X    

## In-place IDGT via Cooley-Tukey
def idgt_gentlemansande(x):
    k = len(x)
    X = list(x)
    
    m = 1
    for stride in range(int(log(k,2))):
        for l in range(k // 2):
            j = l//(k//(2*m))            
            a = invgj_powers[j][stride]            
            i = j + (l % (k//(2*m)))*2*m
            xi = X[i]
            xim = X[i + m]

            X[i] = xi + a * xim
            X[i + m] = xi - a * xim
        m = 2 * m

    return [v*invofkmodp for v in X]

def gen_polynomial_modp(length):
    x = []
    for i in range(length):
        x.append(randint(0,p))
    return x

class TestDGTGentlemansande(unittest.TestCase):

    def test_poly_mul(self):
        print("\nPolynomial multiplication in a non-power of two cyclotomic ring of integers")
        
        a = [3108367, 2055210, 1592648, 6272437, 4283931, 5877094, 5918948, 876357, 4451446, 8262673, 6916889, 3625059, 819988, 3074441, 5827171, 3223371, 2073813, 1619707, 4132923, 134441, 7685565, 5834034, 5545631, 3660168, 461924, 4628966, 4245858, 4718495, 5927846, 6463783, 874487, 3036719, 1523641, 1779874, 2592297, 5911202, 1682276, 1818852, 2550920, 4610649, 974316, 4474925, 3870883, 2430198, 7497417, 955361, 8330145, 6619179, 5208224, 1991885, 6925120, 3057875, 5216231, 3804533, 4002963, 3103410, 7717004, 624963, 7891056, 7358361, 111340, 2313116, 1177566, 4172996, 6385282, 157608, 5166847, 3270320, 8074985, 1258199, 4617200, 409830, 4731929, 3273885, 6775202, 7512415, 1191631, 3466613, 1055246, 5993855, 2574238, 7571585, 4647731, 6997626, 2352319, 6507106, 4507483, 5917069, 6913234, 50224, 3456528, 1029783, 2313392, 8347498, 5976190, 6542933, 576718, 3637803, 8142084, 2299457, 2087956, 6622236, 227431, 1711818, 1076645, 4320431, 8336978, 6262784, 7511022, 7165973, 2217892, 2548235, 590817, 7728424, 5674702, 1599128, 7108547, 5301561, 796931, 6452832, 5296218, 4452825, 5066516, 3259993, 3067694, 5877644, 5989560, 1825426, 6861820, 2380685, 2766615, 3570590, 2113711, 7480203, 8009773, 3109951, 658996, 2330628, 7140638, 4768447, 4669475, 6509587, 2827658, 4514410, 2580080, 2812565, 6385114, 108275, 6050774, 2103941, 3096875, 2348607, 1159151, 1690934, 175653, 7979228, 3700218, 6199969, 5267899, 7114432, 6358769, 4075217, 1759191, 7498260, 2971035, 5190208, 787215, 3618813, 4901228, 6031328, 2618946, 3666269, 5727671, 7942271, 6567707, 5142500, 7243335, 4908572, 8024751, 3695703, 2725724, 3351679, 1258550, 3873837, 5711840, 1395427, 5471440, 6600988, 277373, 1855533, 1588236, 6614464, 6226865, 6306443, 2386924, 5153901, 6163504, 8266968, 6920174, 1241564, 5892454, 4283839, 2804792, 502158, 4665726, 5922927, 3085715, 4553404, 6797508, 6015892, 2092474, 4744667, 7955606, 2819479, 4514177, 2656372, 1988772, 1918016, 5870203, 6122755, 2989283, 7371903, 6167787, 1182103, 611126, 4124840, 4583622, 324716, 6762015, 7818034, 5759027, 1040303, 3868671, 6159425, 5490318, 5213529, 2174339, 1576651, 5104356, 2542219, 7281816, 621259, 97862, 8063238, 1058535, 1996242, 7769967, 3564207, 8107443, 6249263, 4853963, 7801814, 3591441, 5157078, 3066436, 2108985, 1624241, 8120254, 1005836, 6997392, 2954447, 4130260, 8172565, 2707860, 7943108, 7651819, 6322939, 3040913, 6267013, 2751380, 3025898, 1202637, 313441, 2326245, 180454, 2926475, 4538666, 2361389, 54466, 1262047, 3461870, 3490911, 4411230, 4029320, 7868124, 2933456, 1106785, 1586620, 4237458, 6948336, 4479901, 2511388, 7449176, 2566279, 6044654, 2528494, 298184, 8160761, 5993707, 1069500, 4129686, 7569321, 5791349, 6170208, 387714, 3372026, 8325105, 2419105, 65341, 4636829, 7091267, 4130999, 333867, 7423604, 20830, 3177877, 2477570, 2739448, 191713, 2321902, 5217078, 3630279, 2603522, 4987054, 3523, 2848098, 3211799, 2659395, 2242705, 4776928, 5526426, 4175355, 5303461, 834213, 740810, 822159, 6033421, 4037660, 294212, 5962029, 1081325, 2117572, 1636102, 3847761, 4359107, 1173425, 7059490, 5017704, 776827, 2888902, 3337652, 923362, 2537375, 5735206, 4543584, 5253089, 4728052, 7903320, 1065399, 3459234, 4369004, 4261570, 531804, 4598520, 7087944, 8392977, 2715493, 5966366, 2344753, 3295741, 1075921, 5900215, 3238115, 7665611, 3698267, 2110568, 2440110, 7675905, 3861630, 1896058, 851137, 5985480, 5125131, 6432621, 3335442, 7805559, 3409637, 5184518, 1852641, 6490627, 5350216, 1573297, 711786, 8355364, 5453237, 4464759, 7672113, 3467895, 7062646, 6591154, 550329, 6791583, 8370393, 4093121, 6437084, 8402926, 1392280, 7260767, 2723086, 2124573, 5348203, 545261, 8399622, 7165884, 6020645, 3916875, 6935780, 2091358, 525150, 1959488, 1197423, 6710668, 4867890, 3199168, 3306406, 7891694, 2129164, 6616405, 871922, 632001, 2142011, 1520100, 3576433, 5209885, 4740041, 7818876, 1573098, 3128789, 1050487, 3534930, 5853781, 1237823, 545218, 7833093, 7767784, 1969920, 2443092, 1816853, 720773, 4903079, 6756125, 4606844, 452949, 4538265, 7406035, 1329613, 5080164, 6170194, 7109610, 5579723, 4291373, 794975, 2817026, 861300, 2925159, 7959544, 2218223, 3271912, 3251670, 1413360, 7502786, 1560070, 854984, 4366130, 1562606, 1086279, 4889603, 5453530, 6937296, 411139, 171933, 4283536, 167053, 5679680, 7137379, 340600, 7189996, 4393869, 3076187, 2481770, 5986633, 3489559, 3293219, 5717392, 7562702, 8140499, 8122697, 4511008, 331916, 7087637, 3403395, 3945855, 4885896, 1006419, 4112797, 6749370, 5339962, 4738266, 1167321, 3490408, 8256845, 3793191, 141595, 6496819, 6069309, 7816693, 2303652, 7824736, 1011540, 3249805, 5158061, 4382043, 2155735, 4418018, 1786115, 1265726, 7823213, 5549651, 4847707, 6541382, 4202696, 647694, 7204625, 7194286, 8272950, 2390994, 5238562, 4350534, 4324372, 4349748, 6596882, 3962880, 2547443, 6596987, 4449359, 432878, 1884447, 7424387, 1197990, 8239809, 5025380, 3268329, 6817351, 6911621, 6374741, 1533849, 6533310, 4343117, 836778, 4476634, 1417108, 3264145, 7852637, 2400642, 489402, 2934848, 7957104, 5271374, 4055131, 1348036, 3645166, 3237068, 642710, 4101576, 2515083, 5549013, 1436377, 6167275, 6338537, 7547407, 4555370, 568719, 2351381, 2151079, 5433403, 3644787, 5467189, 1144153, 5916468, 7913008, 5807417, 4338992, 1472625, 909613, 268583, 6469858, 8167763, 4378990, 6981890, 2324712, 603322, 1168002, 3859329, 297626, 7629540, 1465507, 7233170, 7318772, 1490413, 6686178, 2548375, 2406946, 4264402, 1750703, 8241962, 3863547, 2769327, 6158464, 4698844, 4872367, 3736590, 114262, 1313944, 4117201, 379520, 2081383, 4247336, 6561364, 1792873, 3057477, 877951, 3395593, 6855201, 3652601, 599680, 5817285, 7890720, 1587341, 1935476, 6994682, 4908512, 395982, 1364678, 1454699, 6001421, 6198126, 2347292, 7991907, 1217879, 7306005, 6278, 4982077, 5750474, 6422997, 7957274, 426792, 1048458, 5748940, 6060975, 5263506, 1785349, 4875636, 4125033, 48543, 1644211, 7987080, 2550535, 7553756, 4887403, 6102103, 7553918, 5253503, 299502, 3125178, 739024, 3547846, 659076, 1633285, 2423410, 608459, 501590, 5520422, 5882211, 7072802, 7291385, 1194004, 4547408, 5199850, 8046954, 2316287, 5707137, 6878079, 1636517, 2202151, 6993588, 7337531, 2135644, 2397498, 4581187, 4194354, 3723178, 7882376, 7342557, 4741115, 494702, 3109443, 5692867, 1190725, 2185548, 6439980, 8350082, 5669110, 7299613, 7998451, 65870, 5404059, 4239823, 1811889, 7630313, 4694988, 1798283, 2080764, 1822749, 4706849, 2624370, 295920, 6101680, 2702052, 4324365, 7355598, 5089531, 420883, 4890147, 5886372, 194520, 1774042, 1855122, 2770628, 6990316, 2382401, 5024579, 3013812, 3532052, 6312184, 7827649, 2018332, 5111233, 5209704, 8167496, 1199875, 7363508, 579135, 1764140, 8311589, 6062226, 6213125, 1254725, 197308, 7947603, 2897666, 2525055, 7355137, 3002363, 7977942, 3723339, 4121333, 5099198, 4876730]
        b = [43001, 8100588, 7795102, 2011468, 1976994, 1015196, 7730047, 6662029, 6483882, 7086108, 8203608, 1364336, 7706404, 83277, 7390463, 1723766, 7209608, 1146099, 821226, 8294280, 1995738, 7913503, 7179166, 8204274, 8132489, 2091347, 6621192, 8140158, 7616147, 6754348, 8244477, 6584022, 1007821, 8241050, 7798054, 6420272, 6639365, 764737, 8110049, 1333841, 320684, 7312633, 1791313, 1105616, 1086332, 1648628, 742131, 6845976, 23060, 398613, 6504228, 1411605, 90827, 7433762, 1756363, 221401, 253516, 624425, 7494846, 6608686, 1472666, 6694191, 777756, 7924636, 1392893, 7782056, 7059676, 1752359, 1343754, 7341232, 6723529, 1942740, 1302618, 7059612, 7961396, 991612, 7135374, 7110852, 7585347, 6837128, 762952, 1891274, 2021405, 737184, 1626104, 552671, 8270370, 7953926, 152259, 6365663, 1067337, 6918492, 1564756, 1418361, 1211361, 6490059, 375169, 352368, 477551, 8039299, 273185, 6509241, 8206493, 26730, 6476195, 83271, 6934521, 176889, 6698768, 1160029, 7943921, 152797, 7192218, 7577840, 8272178, 8311984, 7107690, 7438476, 2052056, 153479, 6809175, 6920896, 432616, 126212, 2090043, 255959, 1350469, 899822, 8247871, 392039, 8172083, 7555544, 1145126, 7679816, 8225957, 203437, 7200814, 1913313, 6540516, 711536, 6813104, 1157762, 362389, 462602, 419484, 950648, 1207128, 1289653, 934861, 6945623, 980495, 1679048, 6523496, 8340271, 6896620, 1204450, 1456919, 1456804, 1795611, 8164804, 1868031, 883428, 1610255, 1592975, 7831202, 8388883, 213389, 480475, 1733905, 6608433, 1940479, 1152835, 6975329, 8092938, 8089794, 386192, 535092, 8012307, 1693179, 6418763, 1521792, 866144, 1443028, 39604, 1540317, 1457759, 6690452, 7331575, 7562541, 7325311, 941176, 2024640, 866940, 6561809, 1490124, 1982320, 8364851, 476911, 6335347, 7147869, 7197871, 7347718, 191897, 6603511, 7115189, 1464511, 6936191, 8102417, 6661370, 1475726, 7602215, 347527, 411146, 351867, 1897356, 595986, 1485067, 292449, 6626959, 8004358, 954189, 1988479, 8309284, 560448, 1263755, 6589950, 958524, 7372343, 6808057, 1441948, 895336, 7147271, 6676194, 1627257, 7303193, 6324803, 1964143, 7566987, 7822950, 940136, 6460350, 1228513, 1941603, 8283771, 1859586, 7380143, 6743288, 8152476, 631744, 286056, 996900, 1216322, 1031720, 6336754, 6574808, 6723189, 2084930, 7285211, 2050466, 7836782, 6539362, 7473484, 7239235, 1951491, 1243717, 1588195, 519834, 6832615, 853116, 1212532, 7044884, 1586860, 6542451, 7774160, 1734080, 171691, 8351743, 726261, 7817928, 7957604, 7480060, 7371349, 1029921, 717958, 322921, 964069, 8292744, 1939982, 8319827, 1791673, 8137372, 1517380, 6842163, 316786, 7500364, 7491436, 1395213, 688581, 7770005, 903836, 1402218, 7157038, 6837268, 7518790, 7411087, 6530438, 8309767, 8317730, 8126290, 980083, 7734926, 966305, 6590375, 1874948, 1709041, 234499, 7797971, 7700138, 957742, 1555213, 7588535, 1131178, 8216869, 6590770, 1854180, 958848, 6734325, 8167814, 7848160, 1494769, 7345364, 516514, 1096297, 7655846, 7102760, 7592723, 343490, 1412658, 946337, 8145329, 1699073, 8258271, 7475541, 815782, 6565904, 767169, 7121914, 1078073, 1970070, 6584808, 524252, 585037, 8088886, 620198, 6469235, 1984668, 8309104, 52702, 7026718, 420518, 1129100, 446435, 1769946, 1239384, 7339539, 136562, 7920158, 6582423, 8255736, 7556423, 6779293, 7913921, 7213098, 6401999, 7860343, 890034, 6673368, 1605616, 511080, 7706300, 568179, 6319265, 1457029, 1043862, 2024807, 1096439, 8385800, 7155650, 1417184, 1729865, 693141, 7184419, 7311954, 99776, 7991669, 6821322, 1688490, 8027929, 6507771, 7380723, 1323222, 1035285, 6353187, 7741253, 7195640, 6484263, 8350472, 1459919, 7312327, 1673970, 412752, 2040247, 7875537, 1687567, 1493579, 8151687, 328996, 6593901, 6889423, 883640, 1105805, 1021146, 6902947, 7986748, 368235, 8272370, 7892388, 7014029, 7010872, 8221138, 1926333, 1228888, 7916007, 161179, 32373, 659102, 8148996, 1369081, 687606, 1468222, 7900997, 1022520, 7249856, 8402546, 1577576, 1274227, 6726119, 6933485, 6993580, 7858582, 223245, 153798, 7573994, 673877, 6908364, 7322972, 8122915, 6458, 502068, 386690, 7706532, 6952197, 6679863, 7532752, 8073528, 7854921, 1801260, 1822343, 1932168, 1659616, 507920, 40183, 8092633, 1845293, 6726689, 1330790, 6949486, 988653, 1460780, 671766, 8344209, 1249573, 377508, 7687518, 1968088, 367195, 1066197, 7019382, 1443726, 6401230, 929185, 7356542, 730448, 196717, 974472, 7180929, 8051626, 8135190, 7563157, 6960102, 8352304, 294591, 7635902, 1327760, 7767389, 1871689, 7840051, 225746, 1319863, 6811189, 670171, 7174413, 7352302, 6499321, 40162, 6381277, 1465456, 7195370, 1557520, 858028, 7293664, 8074510, 321141, 8187212, 7964103, 1982634, 1029858, 1271900, 8389379, 6826063, 7709294, 956258, 1636078, 845287, 214576, 7191012, 7965528, 7682637, 7118145, 6454290, 1653330, 7559861, 1201859, 331281, 1007050, 1507708, 1982384, 8267776, 7076885, 6659930, 1693521, 1767568, 323262, 7621139, 6672453, 1289234, 1969736, 6493426, 7924746, 731430, 1886414, 8192742, 1698073, 8177118, 6788312, 7496958, 155612, 8334565, 1016721, 6468322, 1430176, 7853292, 6795145, 508943, 7845321, 8096266, 473649, 6986075, 1536251, 987835, 6715496, 6652712, 7490743, 512967, 351565, 8262556, 1243681, 6864971, 7487388, 1145827, 1079037, 7644225, 7720828, 6776427, 7161871, 6909121, 1697399, 8079035, 554695, 716408, 6890184, 8067341, 1236286, 1319166, 1713216, 6716289, 1301834, 6684025, 635514, 1781454, 8252904, 786830, 7661852, 68842, 1600957, 17873, 898658, 6843318, 8034733, 741794, 269946, 473053, 6779665, 706481, 882846, 33427, 7547584, 6440055, 6835834, 6400049, 7660291, 6650834, 1313670, 7817369, 410018, 1705969, 6879149, 195204, 1463920, 433238, 1976977, 7967438, 6610327, 398524, 7440217, 656583, 788180, 7066680, 8263630, 273052, 7313895, 1988963, 937357, 742398, 552131, 8106697, 731644, 458397, 7409701, 8150910, 1405636, 8209384, 6807850, 7705513, 1763516, 6631654, 7429438, 6845989, 1524646, 997907, 555755, 8158997, 600582, 1235892, 1552141, 7378216, 7750586, 1152120, 1123253, 1219254, 180550, 1505624, 819651, 7761686, 8184596, 7504230, 498312, 1975809, 826807, 8366722, 8314712, 7025234, 8211995, 6666928, 1284566, 1472734, 7315520, 6821457, 674323, 949270, 6537805, 1301586, 1510641, 1507717, 82630, 8377211, 47480, 7631541, 914313, 6580533, 8182825, 499990, 7240390, 2005298, 6647994, 6679477, 6434823, 1895750, 790465, 6357079, 1743591, 7406043, 1819685, 7314906, 852831, 1410920, 819592, 7635806, 6658263, 86981, 7784282, 6363998, 7499851, 1948798, 7638590, 941761, 84520, 7505185, 634844, 6510326, 7185914, 305507, 7666467, 461542, 443451, 6450102, 7525629, 534912, 1516196, 1378586, 7734818, 905644, 8299945, 1771989, 139738, 1570147, 1832805, 6425284, 8152220, 6537668, 6374179, 1559030, 111385, 1601404, 257460, 8064602, 2045602, 1534553]
        ab = [6732980, 2739551, 5819531, 4562628, 4525248, 4827462, 6695889, 3928100, 2214891, 558672, 3432828, 2502603, 8075506, 304036, 5853103, 2129495, 511442, 2541171, 7160261, 5471595, 756762, 3961925, 6948273, 2136791, 116145, 3546349, 4476651, 6365252, 815681, 8108009, 5220397, 2233898, 741917, 8317549, 2204180, 1824653, 7001370, 2478288, 579111, 794790, 2019776, 5030361, 2155609, 6867657, 5920262, 6793621, 6866776, 1293089, 6308602, 6421600, 5022104, 6557761, 6827472, 4407370, 7501414, 1073908, 5441061, 3564568, 2722164, 3086380, 4997380, 6512589, 4463190, 7023815, 5047964, 6831822, 2306038, 5767661, 8020668, 3157286, 6092010, 5412461, 1958549, 2614579, 1141783, 5490816, 3740713, 8118710, 7853078, 8244947, 4120371, 1508383, 3000625, 4217671, 2175130, 2336247, 7657906, 2708519, 1339706, 7682650, 1675337, 7946692, 6929507, 2951784, 6384491, 1762993, 7409462, 4683935, 5564891, 6725641, 469109, 1558364, 7124846, 6640723, 8075851, 5968269, 8253188, 3421145, 3037786, 7751451, 3854481, 511370, 63947, 882273, 1453228, 2282894, 7845604, 2018890, 7648124, 5256819, 7937257, 4209358, 2522639, 7912676, 5582192, 6004746, 6922260, 2475343, 6493898, 6222467, 57872, 1072243, 4626132, 6951729, 464743, 738010, 5010916, 6823571, 568654, 715791, 5270451, 5344598, 5542100, 3378321, 1254841, 1265154, 5972465, 1344168, 7968967, 7984039, 573570, 5503795, 8372683, 1427516, 8065327, 718835, 2667351, 1387759, 8199506, 8073457, 2298296, 6827815, 5640466, 7048743, 7361899, 1153337, 3984720, 151404, 1772460, 5437839, 6540799, 5384144, 5677164, 6708819, 4779204, 5620681, 6487283, 657231, 2857456, 5355276, 7284610, 7909493, 3544211, 2101088, 5724903, 2822905, 6404687, 4369984, 6152064, 74125, 1911240, 4996070, 2073968, 4312054, 2418181, 5882029, 662150, 2182840, 2985037, 6736193, 2384167, 976395, 2314218, 2673203, 2852097, 5986740, 709720, 7621476, 151870, 2440715, 448754, 4708038, 4367281, 7895475, 7932711, 5765448, 4573701, 6759027, 7301770, 2517873, 4338166, 6924481, 2360225, 4289851, 2839164, 8386201, 2928037, 6456339, 5549053, 3193508, 1100981, 5507641, 5442508, 3167579, 1646374, 5224283, 7871629, 1005894, 8049386, 4811811, 4919396, 6544281, 7746436, 5718921, 3935132, 2543294, 1012922, 4782405, 8187431, 3141829, 7296157, 4644962, 4290363, 4543333, 7486440, 3848542, 6959087, 7261536, 3362357, 5188066, 7611891, 7949148, 319287, 4699299, 7579371, 2894146, 3170045, 7712073, 5439835, 3608272, 5277209, 948189, 7170012, 7950177, 7116398, 2843925, 8348604, 3154413, 5073717, 3369477, 8250267, 6961506, 5027434, 5379735, 3136479, 1128141, 1585102, 7973087, 8171483, 823910, 7328703, 5582041, 5416640, 1575369, 915075, 2031693, 374852, 5469691, 302491, 2860933, 4200908, 6549063, 2716721, 5403175, 7624791, 5145753, 532855, 2347538, 5363883, 36275, 2964528, 6272497, 3777091, 3858985, 882729, 1058411, 3972128, 3073582, 2239496, 582892, 6099595, 1329671, 7035383, 3868690, 3218833, 3109818, 7145264, 2395806, 5760706, 7186086, 7004287, 808036, 1800759, 399543, 2754070, 3405730, 536787, 3349301, 5231687, 7941087, 1601791, 7960060, 4851509, 1646508, 4737527, 5749300, 7625690, 2109934, 6818191, 2005319, 2874380, 1389300, 1748558, 2123492, 54362, 8139633, 5094112, 1425797, 5061982, 6241356, 4450615, 5223143, 6690563, 3477545, 8305196, 6321704, 5985385, 611847, 552076, 2185376, 199244, 1736228, 4104539, 4967815, 7673389, 6561499, 7925775, 5954279, 6382076, 7866946, 4570786, 974544, 1214563, 1862830, 2299797, 4901291, 3691170, 4972884, 8297427, 7423515, 75594, 2339763, 8064941, 7613279, 7655416, 2994582, 6014879, 7107507, 1655883, 1347583, 4275746, 424441, 6682278, 4344917, 2686791, 5630472, 6553530, 1324934, 6388991, 5795826, 2466838, 4951234, 218924, 2196405, 3959761, 1383012, 1802522, 2331912, 1691497, 7739772, 767740, 3595768, 4141556, 7046736, 546908, 8163889, 2911388, 1027450, 1832234, 800677, 2194116, 1530219, 6540172, 3730307, 4001054, 6110998, 3492124, 1452695, 1667246, 3261352, 2488698, 1526547, 4884246, 3191772, 350102, 555898, 147665, 1092309, 7599050, 1841183, 6460603, 1521317, 805571, 5403572, 2139375, 1926401, 5271349, 5138135, 6772805, 1897956, 8300595, 4664620, 6131295, 6747644, 4706102, 5554734, 6087595, 3502609, 832927, 1861840, 1365289, 6867862, 1669564, 3185185, 7597082, 3366965, 1712152, 4458236, 1177229, 7218006, 6007312, 6051861, 4502481, 2097684, 1605073, 8071864, 1287022, 8339856, 2729826, 3177289, 3060949, 2187139, 6943299, 5625585, 2444512, 1727166, 1895904, 6587692, 7117684, 3889140, 740384, 5905390, 1546131, 3018521, 7444448, 6287738, 7080040, 4668635, 8270666, 1878103, 4181494, 1234705, 872987, 4738244, 3120796, 6793922, 4987126, 2781707, 5279075, 5619672, 6863429, 6565100, 3599697, 1170533, 7255550, 6369916, 3996217, 4133832, 2556765, 4866430, 8139293, 2187387, 7739814, 1713601, 436090, 6551728, 5025374, 4850552, 8399680, 8387714, 707488, 8093118, 3169330, 3053090, 1853907, 6556168, 5735961, 6409268, 6615600, 3995621, 3324371, 3618211, 1784602, 7879815, 3860098, 7205110, 2251452, 3091800, 420953, 288276, 335336, 7629399, 8004563, 4128105, 441294, 5310573, 3198007, 2989771, 7331648, 4200201, 2327899, 3576401, 4147909, 496199, 3969753, 7369997, 1344422, 6960085, 6972213, 1586357, 1963235, 3407621, 7645493, 3548551, 1104322, 2718422, 2006520, 4984950, 5906671, 3561525, 593082, 1326805, 1224604, 6520960, 8078007, 2032256, 4903707, 355902, 7076637, 6622871, 4793168, 5696428, 2912222, 4770777, 8228795, 4104332, 5652712, 2654825, 6912344, 4775116, 3321013, 3409757, 750574, 2884052, 603258, 1421600, 4740420, 6537988, 5625737, 3145312, 5588323, 2946668, 6352285, 2891300, 1133723, 2730782, 8076123, 2463217, 7471962, 3063111, 2998854, 6290920, 8390906, 8204332, 6859499, 6539955, 3284383, 5947744, 6939912, 1127386, 2545201, 788705, 7198295, 4266525, 8397473, 3352480, 8284825, 181475, 2709880, 7651201, 5338830, 6094812, 1226325, 3736899, 5779513, 3451586, 6524782, 1387028, 3235869, 2572487, 7932527, 7338366, 4491600, 139589, 5444481, 8296729, 115128, 7316331, 8130900, 2959370, 5398, 5125685, 4972927, 4884666, 2032588, 5069475, 5123365, 1139354, 5737489, 8045492, 7748788, 5629612, 2808636, 6877008, 105159, 42338, 3528688, 1045971, 7528712, 2729769, 3485447, 2341384, 7309365, 2723214, 7210745, 4364306, 7310446, 5778130, 4501556, 1299558, 1503766, 5356658, 10894, 3613842, 4029040, 4402155, 7962964, 3395873, 2902518, 5146925, 4839213, 1145075, 3978609, 3072478, 5685421, 5004110, 3711153, 2338844, 6361391, 1000416, 5730570, 5868995, 778564, 5358911, 6663110, 1370960, 452584, 8166486, 3235082, 1710868, 2867260, 5517457, 6322276, 5797691, 7533523, 3238384, 8060097, 6393732, 7122271, 1921355, 570017, 3934160, 2276286, 4999530, 8028021, 278552, 4040679, 6095500, 6144022, 1049703, 1822940, 2102955, 5155697, 7107417, 6575155, 8401431, 3428118, 4182032, 2105002, 3364149, 5267021, 6373989, 4511489, 8101596, 5571956, 1484280, 5225725, 665035]

        start_time = time.time()
        c = poly_mul(a, b)
        end_time = time.time()

        print("----------", end_time - start_time, "s. ----------")

        assert(c == ab)

if __name__ == '__main__':
    unittest.main()