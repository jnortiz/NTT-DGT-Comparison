import unittest
import time
from random import randint
from math import log

from gauss import GaussianInteger
from params import *
from params_dgt import *

def poly_mul(x, y):

    x_ntt = dgt_6(dgt_2(x))
    y_ntt = dgt_6(dgt_2(y))

    mul = [(x*y) for x,y in zip(x_ntt, y_ntt)]

    z = idgt_2(idgt_6(mul))

    return z

def dgt_2(x):
    output = []

    # For each block of N coefficients
    for i in range(6):
        
        block = []

        # Extract the i-th block
        for j in range(N):
            block.append(x[N*i+j])

        # Fold the signal: for now on, the block has size N//2
        block = [GaussianInteger(x, y) for x, y in zip(block[:N//2], block[N//2:])]

        # Twist the folded signal
        block = [block[j]*nthroots[j] for j in range(N//2)]

        # Compute the DGT for each of them
        block = dgt_gentlemansande(block)

        # Save dgt(block) in the output
        for j in range(N//2):
            output.append(block[j])            

    return output   

def idgt_2(x_dgt):    
    
    output = []

    # For each block of N//2 Gaussian integers
    for i in range(6):
        
        block = []

        # Extract the block of Gaussian integers
        for j in range(N//2):
            block.append(x_dgt[(N//2)*i+j])

        # Compute its counterpart in the ring defined by x^{2**7}+1
        x = idgt_gentlemansande(block)

        # Remove twisting factors
        x = [x[j]*invNthroots[j] for j in range(N//2)]

        # Unfold the output and save the idgt(block) into its correspondent place in the output
        for j in range(N//2):
            output.append(x[j].re)

        for j in range(N//2):
            output.append(x[j].imag)

    return output 

def dgt_6(X):
    
    x = list(X)

    # For each of the N//2 blocks of Gaussian integers
    for j in range(N//2):        
        
        x_tilde = []
        
        # Extract 6 elements
        for i in range(6):
            x_tilde.append(x[(N//2)*i+j])

        x_tilde = [x_tilde[i]*theta[i] for i in range(6)] # theta transformation

        # mu transformations
        s0 = x_tilde[0] + x_tilde[3]
        s1 = x_tilde[1] + x_tilde[4]
        s2 = x_tilde[2] + x_tilde[5]
        s3 = (s1 - s2) * theta[3] # zeta = theta^3

        x[(N//2)*0+j] = (s0 + s1 + s2) 
        x[(N//2)*2+j] = (s0 - s2 + s3) 
        x[(N//2)*4+j] = (s0 - s3 - s1)

        s0 = x_tilde[0] + x_tilde[3] * theta[3]
        s1 = x_tilde[1] * theta[1] + x_tilde[4] * theta[4]
        s2 = x_tilde[2] * theta[2] + x_tilde[5] * theta[5]
        s3 = (s1 - s2) * theta[3]

        x[(N//2)*1+j] = (s0 + s1 + s2)
        x[(N//2)*3+j] = (s0 - s2 + s3) 
        x[(N//2)*5+j] = (s0 - s3 - s1)

    return x

def idgt_6(X):
    x = list(X)

    for j in range(N//2):        
        x_tilde = []
        
        for i in range(6):
            x_tilde.append(x[(N//2)*i+j])

        # mu_death
        t0 = (x_tilde[2] - x_tilde[4]) * theta[3]
        t1 = (x_tilde[3] - x_tilde[5]) * theta[3]

        s0 = x_tilde[0] + x_tilde[2] + x_tilde[4]
        s1 = x_tilde[1] + x_tilde[3] + x_tilde[5]

        x[(N//2)*0+j] = s0 - s1 * theta[6]
        x[(N//2)*3+j] = s0 - s1

        s0 = x_tilde[0] - x_tilde[2] - t0
        s1 = x_tilde[1] - x_tilde[3] - t1

        x[(N//2)*1+j] = s0 - s1 * theta[5]
        x[(N//2)*4+j] = s0 - s1 * theta[8]

        s0 = x_tilde[0] - x_tilde[4] + t0
        s1 = x_tilde[1] - x_tilde[5] + t1

        x[(N//2)*2+j] = s0 - s1 * theta[4]
        x[(N//2)*5+j] = s0 - s1 * theta[7]

        #psi_death
        x[(N//2)*0+j] = (x[(N//2)*0+j] * one_minus_zeta_by_nine)
        x[(N//2)*1+j] = (x[(N//2)*1+j] * one_minus_zeta_by_nine * theta_inv[1]) 
        x[(N//2)*2+j] = (x[(N//2)*2+j] * one_minus_zeta_by_nine * theta_inv[2])
        
        x[(N//2)*3+j] = (x[(N//2)*3+j] * zeta_minus_one_by_nine * theta[3])
        x[(N//2)*4+j] = (x[(N//2)*4+j] * zeta_minus_one_by_nine * theta[2])
        x[(N//2)*5+j] = (x[(N//2)*5+j] * zeta_minus_one_by_nine * theta[1])      

    return x

## In-place DGT via Gentleman-Sande
def dgt_gentlemansande(x):   
    k = len(x) # n//2 | 256  
    X = list(x)
    
    for stride in range(int(log(k,2))):        
        m = k // (2<<stride)

        for l in range(k // 2):
            j = l//(k//(2*m))
            a = gj_powers[j][stride]
            i = j + (l % (k//(2*m)))*2*m
        
            xi = X[i]
            xim = X[i + m]
            X[i] = xi + xim
            X[i + m] = a * (xi - xim)

    return X    

## In-place IDGT via Cooley-Tukey
def idgt_gentlemansande(x):
    k = len(x)
    X = list(x)
    
    m = 1
    for stride in range(int(log(k,2))):
        for l in range(k // 2):
            j = l//(k//(2*m))            
            a = invgj_powers[j][stride]            
            i = j + (l % (k//(2*m)))*2*m
            xi = X[i]
            xim = X[i + m]

            X[i] = xi + a * xim
            X[i + m] = xi - a * xim
        m = 2 * m

    return [v*invofkmodp for v in X]

def dgt_gentlemansande_mul(a, b):        
    N = len(a)

    # Initialize
    a_folded = [GaussianInteger(x, y) for x, y in zip(a[:N//2], a[N//2:])]
    b_folded = [GaussianInteger(x, y) for x, y in zip(b[:N//2], b[N//2:])]

    # Twist the folded signals
    a_h = [a_folded[j] * nthroots[j] for j in range(N // 2)] 
    b_h = [b_folded[j] * nthroots[j] for j in range(N // 2)]

    # Compute n//2 DGT
    a_dgt = dgt_gentlemansande(a_h)
    b_dgt = dgt_gentlemansande(b_h)

    # Point-wise multiplication
    c_dgt = [(x * y) for x,y in zip(a_dgt, b_dgt)]

    # Compute n//2 IDGT
    c_h = idgt_gentlemansande(c_dgt)

    # Remove twisting factors
    c_folded = [c_h[j] * invNthroots[j] for j in range(N // 2)]

    # Unfold output
    c = [c_folded[j].re for j in range(N//2)] + [c_folded[j].imag for j in range(N//2)]

    return c

## Schoolbook polynomial multiplication in Z_q[x]/<x^N + 1>
def schoolbook_mul(a, b):
    assert len(a) == len(b)
    N = len(a)
    c = [0]*N

    for i in range(N):
        for j in range(N):
            teste = (-1)**(int((i+j)//float(N)))
            v = a[i]*b[j]*teste
            c[(i+j) % N] = (c[(i+j) % N] + v) % p

    return c

## Scalar multipÄºication in DGT's domain
def dgt_gentlemansande_mulscalar(a, b):
    N = len(a)

    # Initialize
    a_folded = [GaussianInteger(x, y) for x, y in zip(a[:N//2], a[N//2:])]

    # Twist the folded signals
    a_h = [a_folded[j] * nthroots[j] for j in range(N // 2)]

    # Compute n//2 DGT
    a_dgt = dgt_gentlemansande(a_h)

    # Point-wise multiplication
    c_dgt = [x * (b % p) for x in a_dgt]

    # Compute n//2 IDGT
    c_h = idgt_gentlemansande(c_dgt)

    # Remove twisting factors
    c_folded = [c_h[j] * invNthroots[j] for j in range(N // 2)]

    # Unfold output
    c = [c_folded[j].re for j in range(N//2)] + [c_folded[j].imag for j in range(N//2)]

    return c

## Schoolbook scalar multiplication in Z_q[x]/<x^N + 1>
def mulint(a, b):
    assert type(b) == int
    N = len(a)
    c = [x * b % p for x in a]
    return c

def gen_polynomial_modp(length):
    x = []
    for i in range(length):
        x.append(randint(0,p))
    return x

class TestDGTGentlemansande(unittest.TestCase):

    def test_transformation(self):
        print("\nTesting DGT Gentleman-Sande")        
        x = gen_polynomial_modp(N//2)        
        x = [a if isinstance(a, GaussianInteger) else GaussianInteger(a) for a in x]
        
        start_time = time.time()
        y = idgt_gentlemansande(dgt_gentlemansande(x))
        end_time = time.time()

        print("----------", end_time - start_time, "s. ----------")
        
        self.assertEqual(x, y)      

    def test_mul(self):
        print("\nPolynomial multiplication using DGT Gentleman-Sande")
        
        a = gen_polynomial_modp(N)
        b = gen_polynomial_modp(N)

        start_time = time.time()
        c = dgt_gentlemansande_mul(a, b)
        end_time = time.time()

        print("----------", end_time - start_time, "s. ----------")

        self.assertEqual(c, schoolbook_mul(a,b))

    def test_mulint(self):
        print("\nMultiplication by scalar using DGT Gentleman-Sande")
        
        a = gen_polynomial_modp(N)
        b = randint(0, p) # An arbitrary scalar number

        start_time = time.time()
        c = dgt_gentlemansande_mulscalar(a, b)
        end_time = time.time()

        print("----------", end_time - start_time, "s. ----------")

        self.assertEqual(c, mulint(a,b))

    def test_poly_mul(self):
        print("\nPolynomial multiplication in a non-power of two cyclotomic ring of integers")
        
        # Example of correct output produced using the qTESLA-V-size reference code
        a = [20230862, 22295447, 31886032, 5443541, 3217776, 19992030, 25816013, 32273557, 19482893, 25905261, 4286427, 3862895, 885386, 11633796, 12811145, 2893330, 33232327, 31785714, 31817203, 21406975, 31248845, 9519473, 10629704, 7040116, 14914282, 18155512, 7164008, 9484826, 20637668, 20754942, 20549840, 25937698, 14673720, 29823771, 24275761, 7773536, 15551697, 16136988, 4652164, 17067224, 3232814, 30435985, 8291590, 1076616, 1138775, 4565109, 12052256, 32211677, 32720728, 26258064, 27175265, 24507930, 23183039, 16486332, 11172691, 1219802, 24667225, 31467845, 5301809, 26044140, 32297787, 24895565, 31247368, 33171139, 360508, 3252357, 13796321, 17648575, 15389484, 2981657, 309952, 10666822, 8123497, 23544309, 16066096, 22426850, 32815843, 8769002, 26538265, 31036547, 3076092, 24752737, 32330418, 31428050, 28591273, 30982503, 32973248, 26563004, 6962436, 5065429, 23890259, 19319084, 17017640, 12459182, 19966487, 30340403, 18373571, 27562340, 5207533, 13890916, 30866500, 12690339, 26667811, 6624627, 1939121, 17562604, 11392740, 11747988, 20050957, 15574022, 7437812, 31616963, 6841116, 18275415, 7949949, 27957855, 11236955, 16686092, 18179175, 21249279, 25432957, 25410822, 1045722, 9131538, 20976017, 29257516, 23699796, 10610468, 25971123, 10558386, 21116511, 3881839, 11178360, 31230089, 2139174, 7749202, 13421833, 31061665, 16563744, 27465634, 10178480, 12333042, 22820365, 19036046, 22732327, 30188814, 539863, 6061596, 29644945, 5483514, 26485418, 10541967, 18228073, 9123091, 6840885, 20241317, 5998295, 4860134, 7874991, 22523215, 5612321, 20417977, 1248652, 30883850, 28735455, 17266305, 15129762, 8596950, 23455949, 12420450, 23394205, 19417129, 15419473, 24703130, 12912908, 16617321, 31583654, 8033791, 26817743, 15816251, 3044241, 11349973, 17442734, 10578425, 1887234, 3940097, 30491847, 21032155, 30591989, 18850072, 314687, 25394707, 5627930, 23398290, 875575, 14207368, 32350132, 1833756, 13980971, 24921943, 11552614, 2222145, 2528921, 15275134, 3564305, 3398372, 13386901, 17946953, 33045920, 14991493, 13197953, 15375844, 1383592, 32394946, 9439428, 4578608, 25669813, 14628067, 12636328, 20636110, 23074264, 23425042, 13525765, 27829056, 15627301, 623247, 21646309, 15077512, 20347201, 8012049, 28295432, 10982491, 69035, 8584446, 32913127, 15473470, 5515027, 11070798, 10030680, 20330807, 8041459, 20524456, 5644428, 9028138, 26907830, 21860758, 25063571, 23306395, 12548440, 17763167, 21005951, 19879186, 3429290, 7882647, 19357334, 18576452, 25609413, 26237994, 10350723, 18799235, 23206694, 3183589, 17970534, 3801950, 33116342, 24145051, 33286079, 26231338, 25077208, 25935867, 29275452, 1002263, 4790885, 30971002, 4235661, 15717624, 27792205, 3200829, 16722135, 24835389, 17106048, 22443516, 13668912, 15595181, 4010864, 31221541, 25897347, 9725138, 850918, 2373186, 891380, 31427883, 22019448, 2718432, 6168718, 26523450, 4514014, 25802640, 14083138, 13466853, 21595581, 33405665, 21523478, 27579425, 18580532, 29199315, 18646119, 30763326, 19079569, 15604651, 4208265, 30445792, 3694177, 16705715, 20368468, 31597294, 17056418, 8742688, 31767019, 28914650, 21069624, 21943234, 25005567, 31303482, 24672787, 3886420, 30115950, 8908537, 15075709, 23993981, 24862569, 30840929, 28569124, 24271775, 25047911, 14472438, 20795696, 33118168, 3173434, 11241874, 19428263, 8818739, 31905355, 33354161, 25770283, 22449736, 3022265, 10184390, 17582846, 24994966, 23610925, 30104332, 16741984, 19750532, 20270570, 15988044, 22789040, 444688, 16112031, 18675869, 7988774, 15186679, 21326867, 17893322, 14276386, 28978954, 6854287, 13360001, 10631308, 8450987, 13832485, 10678133, 22948560, 30973159, 2536224, 3287604, 14346324, 12131498, 16663102, 18396428, 11514249, 2643066, 18525791, 22770841, 4308550, 16619932, 28549463, 29564629, 14370132, 10304561, 29803216, 28293387, 23314204, 27149675, 23322049, 1593550, 32111346, 28420646, 30946169, 5178840, 16848299, 32137445, 25280692, 4913248, 268237, 29229264, 3125668, 21065671, 29802126, 932844, 7348266, 1925958, 14074800, 16749328, 26882731, 7971766, 11573146, 18866509, 6819244, 12588763, 7873997, 8032921, 31752558, 33317946, 5835153, 18503480, 16424780, 20476170, 30120401, 11857369, 16638627, 7987103, 6546767, 31544887, 21669812, 5043668, 27831787, 4704030, 31603094, 24999888, 16436028, 11731809, 26123513, 28296150, 26414824, 20600882, 11371031, 17008907, 18824769, 24187193, 19371374, 6935708, 11299828, 24124434, 24074898, 1976817, 4535299, 22648288, 27963182, 28296381, 29903180, 2558315, 22347270, 30213490, 24557794, 10340974, 303181, 31052164, 31923706, 15255723, 3469942, 17531364, 33292240, 25205078, 27294921, 16993986, 14793892, 32343918, 28952892, 31488148, 31541832, 13352503, 17483254, 11863133, 9272101, 2935183, 9869026, 26925219, 30038553, 9332250, 23866296, 24868396, 8403126, 7788342, 7189726, 16259211, 10438394, 19124036, 3048874, 28929764, 8126903, 28356623, 15722296, 21302583, 10034584, 2723651, 53529, 2272111, 30896286, 26323201, 17313222, 30021608, 5657583, 27800444, 4697245, 18266046, 13456304, 26171577, 18852990, 31917344, 17306692, 16856281, 31220319, 32355907, 2599413, 29855598, 11680661, 13790578, 18716978, 9301901, 4034815, 33280790, 12401420, 7523586, 1433703, 15507880, 9555381, 2004834, 16896984, 948159, 4253629, 757025, 21946689, 17778109, 13473287, 29562224, 26621450, 29106652, 3736002, 1981604, 23951511, 28709825, 27773087, 21270352, 19730009, 23635147, 14422393, 5423243, 20795378, 26826063, 2941587, 17326889, 9736488, 19879659, 27678936, 8379218, 27713773, 33255299, 14939606, 715020, 24601217, 11647839, 27676562, 31547520, 21103773, 2592480, 3787177, 9362122, 17053374, 33497827, 31469140, 3105553, 10745877, 5245040, 13509819, 1964841, 2016937, 7342778, 18787471, 18940820, 17820349, 28052763, 2999915, 14215469, 3459194, 14792569, 1116221, 26324369, 5321908, 17923481, 24491456, 7592761, 20923930, 31036473, 22976475, 3960727, 30407898, 2474500, 21398399, 10914755, 10512568, 9043961, 23525161, 6129187, 32308956, 162783, 16742825, 9560188, 20350336, 15894585, 32583030, 23917920, 6708704, 1562457, 4485164, 22601028, 10907288, 9296067, 22593748, 6010773, 5017525, 28151831, 6441135, 13827793, 29812566, 14005141, 23819767, 18987723, 31408820, 30471629, 24790857, 11651085, 24974991, 15056981, 7485333, 24231900, 21282769, 9081346, 30216896, 3299827, 5966879, 12290391, 16718027, 11531413, 25164378, 3116530, 23984918, 26326781, 8291533, 30970841, 27542342, 28723246, 29195201, 8974774, 1827177, 9695402, 3088047, 26041708, 5390749, 7429024, 24802633, 18660296, 14694990, 18769700, 19550412, 14682192, 26709946, 25334467, 13332941, 7669764, 19343080, 27281068, 4740279, 18816258, 15253681, 12853757, 17625977, 31802049, 8851127, 14905328, 25041529, 21463278, 24143236, 14453544, 5315173, 29282477, 16734895, 16339334, 23223451, 17446658, 22717984, 22346306, 12672368, 16741153, 2280546, 13493758, 20774289, 33371536, 6195166, 31927151, 28465041, 29726073, 10622185, 25451299, 23473530, 30408213, 21684502, 3629166, 20002794, 19375032, 20359840, 10273145, 32510710, 6329913, 4442760, 28514365, 26910865, 15237046, 7714096, 18793005, 20516641, 14222630, 13641753, 12824569, 3544973, 31234515, 16401004, 25156987, 9917417, 3993519, 30369008, 23176330, 9645830, 1137715, 4746025, 26569318, 14914553, 4781261, 12850479, 14922803, 28665830, 31903293, 22970249, 16657619, 7597423, 24126408, 19983053, 8414139, 22817482, 29458361, 4500791, 21847555, 4231709, 24050745, 30293768, 12059490, 25419362, 694973, 16158208, 7982778, 1140788, 13780405, 1173804, 1850944, 1344957, 15996650, 9988176, 10970341, 30401714, 2270648, 989219, 16999948, 6269350, 14871147, 30637541, 22571123, 16951675, 6489486, 1177880, 22912657, 19443725, 9861418, 24020129, 13943009, 12723564, 910052, 7518464, 27037438, 31488120, 7313823, 10447720, 19172646, 30421628, 12236409, 3525116, 20475725, 25005231, 24044908, 30174528, 11147344, 17789090, 27892782, 33468466, 4240741, 13410176, 18676135, 20853495, 21946917, 23501069, 12568431, 29645518, 3178425, 8918558, 31325829, 27283864, 12679950, 15609773, 11268757, 22266829, 28359838, 6894441, 10439848, 4196444, 33039177, 4520220, 2706135, 11608095, 1067481, 18600759, 23102774, 26837630, 4463726, 31302003, 18388563, 23937578, 12160715, 19710344, 1494345, 1984996, 23176140, 29999972, 19905450, 21786569, 10891744, 18096832, 16866470, 10681150, 26089223, 31714654, 26549737, 22279596, 30677613, 6255790, 8318608, 32682415, 18173285, 6134041, 8505307, 32776185, 1510815, 281878, 33199516, 23152819, 27971049, 6054907, 25179122, 13360595, 1223254, 16507391, 7738037, 28304304, 28127069, 19909584, 17861222, 7980579, 4705910, 12633032, 31496779, 13836243, 9816586, 23593917, 13935418, 938123, 5775271, 12077775, 30598639, 31102456, 33385566, 16994741, 30199980, 22966443, 29284546, 17310271, 11330609, 29191201, 28457945, 27679864, 7973315, 15194726, 1405755, 2037044, 18539703, 11601546, 13991069, 1666349, 7484247, 16300210, 16553166, 5935450, 4407253, 6964247, 3574678, 22864876, 7168964, 8840880, 31409930, 21147315, 3299489, 14014630, 5788086, 19790397, 1270228, 16694076, 20404238, 14581334, 23756996, 15358637, 18133042, 11076455, 21510853, 32293895, 15186133, 12527301, 20585525, 22595832, 16501516, 1714113, 28071803, 1017057, 33490668, 21902237, 29108586, 8413672, 6088993, 13526872, 21492437, 16756030, 3775655, 12917650, 20558051, 13123960, 25453371, 20855098, 21356803, 790338, 6707091, 950020, 17132714, 18292656, 15516906, 25624429, 12809956, 31168766, 1048878, 6615795, 8762524, 12149030, 32697713, 32283584, 31751151, 15758856, 25184329, 8578062, 14949650, 12343484, 31782896, 22204668, 8219665, 30254493, 13856877, 1158773, 22515179, 19580264, 30424807, 21514763, 16801182, 26989332, 18195365, 18356967, 23505904, 3865795, 2003891, 2973092, 17447861, 18677676, 3073013, 6673654, 1965859, 21334158, 16963741, 15500045, 18318481, 5685303, 9974682, 29981273, 12056485, 17721589, 30422909, 10854874, 29438623, 7942776, 12015282, 3457949, 17508693, 18305878, 4664768, 26432065, 15782191, 8721462, 5269501, 981846, 5994192, 10446518, 23478631, 13694114, 7582468, 1539017, 13788273, 11417143, 33266626, 25335268, 630090, 18448729, 799789, 1067445, 26827546, 22932062, 16380262, 10722564, 14427974, 12998246, 30089477, 25596555, 1083825, 31721406, 21171066, 24774177, 24894032, 22451897, 16371024, 10401823, 21999975, 1795921, 9245122, 17904803, 21012357, 7391232, 8234880, 15958410, 29067708, 11242929, 31693808, 26436523, 9512558, 16967368, 12401985, 13834723, 12320409, 30959135, 1124095, 5925413, 10832189, 28653741, 21484316, 24112062, 19982175, 7497562, 4182883, 28309957, 21576823, 9085313, 8007860, 30226135, 9460049, 11915689, 31708915, 8879359, 31033091, 22957395, 10814789, 27575325, 12749506, 30657490, 21019736, 13475366, 26594297, 30328016, 6000678, 1628606, 4270113, 13711790, 28833427, 33162292, 26200714, 25928727, 6038150, 15309008, 8634278, 9296132, 11939227, 27114414, 18676031, 4032275, 15713500, 5884308, 5044437, 5184761, 19267872, 13291554, 9103464, 2791539, 26095430, 8283566, 26128781, 21935877, 28004584, 29882270, 31140063, 33018170, 28244499, 10868452, 16039378, 25758407, 4573701, 19561667, 11862293, 27297756, 30729117, 19883707, 31345504, 25304050, 14545110, 9402811, 26377923, 19734790, 30283555, 19308008, 29856324, 235301, 4599365, 14354408, 5398344, 28379479, 10025182, 32045139, 329996, 28128682, 22983269, 25649431, 10628966, 25546010, 7561477, 6311585, 23090838, 18971339, 7504347, 16522824, 13922177, 10666430, 30484294, 5810438, 4999720, 19673745, 6474130, 19138555, 9360862, 24758213, 2900542, 1422825, 7643583, 11024151, 26691487, 24277282, 33008721, 5499043, 1558194, 5878936, 14312522, 28214668, 20648317, 2844909, 23354012, 23569640, 13244470, 18002827, 17232107, 31415420, 3849378, 9038314, 18049839, 31501586, 19823206, 20239656, 2689451, 28501588, 8550447, 4314692, 12320739, 18568851, 2757064, 27414411, 1971102, 20653693, 32073962, 719565, 23765429, 24510024, 8351579, 32026317, 18020161, 32901886, 17580193, 2949495, 25975569, 30377595, 31700867, 19866649, 20896538, 19383640, 28597156, 8581408, 28844636, 6410200, 21574827, 23508415, 30830463, 9310971, 6647517, 28889740, 262008, 23558232, 11569816, 32379112, 2200777, 8278174, 7097782, 24234876, 5550673, 26138885, 713952, 21437451, 8127792, 5387671, 155153, 33184086, 2086550, 11033419, 24664820, 2488680, 8992316, 31662030, 29044965, 15617251, 28701847, 7648036, 24514326, 30651944, 17348503, 30757184, 14234903, 2426702, 20539887, 17959158, 6912138, 1015044, 12833902, 26335358, 16821820, 4131585, 31124781, 19077740, 15299284, 12522062, 12341852, 364147, 512451, 8291474, 21740253, 33113411, 33280444, 15747625, 17757119, 32394282, 4231451, 27630723, 31766468, 10666762, 24017229, 5393851, 31466159, 16832468, 14283239, 8057873, 29169522, 8471427, 9586920, 4144958, 16924410, 32790320, 4453813, 14222162, 2204037, 3540603, 25151681, 10020204, 1409654, 9156909, 10911315, 22664811, 1951279, 11731933, 13457817, 15971611, 18402883, 23154103, 7392248, 14554203, 13629389, 22578526, 16310244, 11198491, 5758061, 21187243, 592004, 7191574, 12773564, 10409221, 25144645, 7239204, 10593358, 7819482, 15609466, 22164009, 28084534, 18440529, 24919598, 26671937, 4026838, 30257849, 30577590, 30335354, 9268195, 32944222, 21073973, 23685941, 8301829, 2004759, 23099281, 28164751, 23884618, 2441324, 19659580, 15440681, 2946281, 29803802, 6331190, 17461985, 19229309, 26912438, 14155026, 4710744, 21908460, 14202946, 7744570, 831907, 26633201, 7152841, 10665559, 33280572, 1853842, 12720715, 6521293, 2272938, 1873777, 18133338, 3394393, 13770016, 3057174, 221178, 19190428, 23253192, 29152824, 17899025, 21533950, 18662446, 4043060, 16244427, 2257727, 24753785, 32146569, 20282088, 23022439, 635126, 12164533, 10108430, 15370590, 5487732, 17716889, 33472862, 6649669, 11635574, 27932723, 9565539, 21417302, 10352158, 21016047, 7430365, 32196419, 13365752, 11515168, 32026167, 1548164, 33376374, 28233148, 23946893, 543051, 27848475, 2694293, 4321323, 2821713, 13858090, 23893944, 18947636, 1042920, 32300153, 21807196, 26717635, 19447932, 12317848, 2509044, 6132292, 31369231, 7702467, 24825907, 29587625, 6930386, 14137091, 31811401, 18480314, 17408528, 16341460, 4840926, 667996, 23166479, 2810743, 20508468, 12001826, 8513432, 30378775, 19509292, 17199962, 13119349, 13839112, 33136896, 33556916, 22043457, 20304870, 4900484, 4510114, 483101, 66409, 13273679, 30489537, 12928589, 29767851, 21440506, 3763843, 15926164, 19648431, 8201520, 9934820, 24167982, 11575112, 7801124, 10121256, 15931796, 29894266, 5277734, 23628253, 31219916, 15176047, 20879279, 29834717, 11707761, 9795949, 15829605, 16123941, 1976532, 13269215, 12258608, 17993443, 2351538, 28710261, 29368296, 13562504, 12217099, 12722155, 23260038, 30220801, 599510, 32423242, 3180848, 5726351, 10571121, 2002684, 935908, 274841, 14885980, 4910309, 1601336, 21977293, 3168850, 25535940, 32516830, 21198036, 19540700]
        b = [12, 7, 4, 2, 35, 19, 33564666, 33564664, 3, 14, 33564670, 12, 24, 10, 2, 33564663, 33564654, 33564669, 4, 33564656, 15, 16, 9, 19, 33564664, 10, 14, 4, 15, 33564672, 33564665, 20, 33564666, 33564672, 1, 0, 6, 19, 9, 33564661, 11, 33564666, 4, 33564668, 17, 16, 33564667, 33564667, 33564662, 8, 33564672, 11, 33564671, 33564662, 33564661, 33564671, 3, 33564651, 6, 5, 1, 33564670, 13, 33564652, 4, 33564649, 33564669, 20, 33564660, 33564661, 8, 0, 33564671, 33564672, 14, 6, 16, 33564670, 11, 8, 33564662, 15, 2, 0, 33564665, 6, 6, 6, 17, 1, 5, 33564662, 6, 21, 14, 3, 33564665, 33564670, 0, 0, 8, 33564668, 33564672, 11, 11, 33564655, 0, 8, 12, 1, 24, 33564666, 33564666, 14, 33564661, 9, 33564669, 4, 33564660, 11, 33564660, 25, 6, 33564669, 33564652, 33564659, 33564671, 18, 33564668, 33564664, 33564672, 33564663, 2, 33564665, 3, 0, 33564671, 16, 0, 5, 10, 33564667, 33564666, 33564663, 19, 4, 20, 3, 5, 10, 33564670, 33564671, 22, 8, 3, 9, 3, 33564666, 7, 11, 33564664, 12, 33564667, 4, 33564666, 33564665, 9, 6, 33564656, 3, 33564668, 1, 4, 7, 33564672, 14, 2, 6, 33564670, 3, 33564668, 33564668, 33564661, 33564655, 2, 1, 33564655, 33564663, 8, 1, 0, 1, 33564665, 33564658, 11, 1, 20, 33564656, 7, 33564663, 5, 33564670, 33564670, 3, 33564656, 33564670, 11, 6, 6, 8, 2, 33564671, 5, 33564667, 33564667, 33564666, 1, 33564671, 7, 33564671, 7, 9, 33564667, 10, 33564654, 33564670, 1, 15, 3, 14, 2, 24, 33564672, 33564652, 3, 33564667, 33564667, 33564672, 8, 9, 4, 0, 0, 9, 33564666, 33564664, 15, 33564665, 33564660, 13, 33564662, 33564671, 10, 33564665, 33564672, 4, 6, 33564652, 33564666, 33564664, 0, 7, 5, 1, 8, 33564666, 3, 6, 16, 33564659, 2, 3, 6, 5, 3, 33564661, 18, 0, 33564667, 33564671, 3, 33564653, 33564653, 2, 33564665, 13, 33564661, 3, 33564655, 33564671, 2, 33564662, 3, 33564668, 33564667, 33564669, 0, 33564672, 11, 17, 11, 6, 33564661, 10, 5, 1, 33564661, 21, 33564666, 8, 33564669, 33564668, 33564672, 3, 10, 33564667, 33564669, 33564668, 9, 13, 33564663, 33564667, 33564666, 4, 6, 23, 11, 13, 33564652, 10, 4, 33564660, 33564664, 33564649, 33564663, 33564672, 33564664, 33564661, 5, 33564654, 14, 2, 8, 7, 11, 0, 33564662, 33564672, 4, 33564662, 33564670, 33564670, 33564668, 33564665, 33564665, 33564664, 33564660, 33564671, 33564668, 6, 33564658, 33564671, 10, 33564667, 7, 33564671, 33564669, 33564667, 4, 33564657, 33564665, 15, 33564662, 2, 7, 33564657, 11, 33564670, 3, 1, 2, 19, 33564657, 33564669, 33564661, 33564668, 33564654, 14, 33564664, 33564666, 33564660, 5, 33564651, 33564668, 33564655, 0, 33564672, 33564668, 10, 3, 33564665, 12, 7, 33564667, 8, 33564668, 4, 33564658, 33564669, 16, 4, 14, 9, 1, 6, 0, 4, 33564661, 12, 33564671, 33564663, 33564667, 3, 8, 2, 33564669, 2, 33564659, 33564668, 2, 33564663, 2, 13, 2, 33564655, 33564664, 33564668, 33564669, 21, 33564665, 9, 4, 18, 33564665, 33564670, 9, 33564667, 9, 33564657, 33564661, 33564672, 7, 7, 8, 33564668, 33564659, 15, 9, 6, 33564665, 33564661, 33564658, 6, 33564672, 4, 11, 33564659, 4, 5, 10, 4, 9, 3, 33564661, 2, 33564666, 5, 13, 33564657, 8, 5, 33564668, 33564670, 33564671, 18, 18, 0, 33564670, 33564666, 8, 33564668, 8, 33564670, 33564671, 33564659, 18, 33564660, 33564661, 2, 9, 33564666, 8, 3, 17, 8, 2, 33564665, 33564666, 33564667, 17, 4, 33564667, 33564654, 33564657, 33564666, 33564671, 33564665, 13, 6, 7, 8, 33564667, 6, 10, 33564671, 33564657, 3, 33564668, 15, 14, 16, 33564671, 4, 8, 11, 12, 33564658, 33564670, 11, 2, 33564670, 2, 18, 9, 33564667, 13, 1, 0, 33564669, 33564671, 33564670, 33564667, 3, 25, 33564650, 33564668, 33564667, 5, 3, 6, 20, 6, 16, 2, 33564669, 33564671, 33564664, 8, 14, 33564656, 33564672, 13, 2, 11, 1, 15, 2, 4, 0, 33564669, 33564658, 4, 33564658, 12, 33564667, 2, 5, 2, 33564653, 12, 33564670, 9, 17, 11, 5, 5, 33564663, 4, 3, 9, 13, 9, 12, 33564669, 33564663, 1, 33564666, 9, 1, 33564665, 33564667, 0, 33564671, 33564664, 33564672, 33564668, 0, 2, 9, 8, 33564672, 0, 33564666, 33564664, 0, 18, 16, 33564664, 0, 33564658, 33564671, 33564661, 11, 33564670, 13, 18, 33564663, 33564667, 11, 13, 13, 2, 33564660, 0, 17, 18, 7, 33564672, 1, 33564667, 11, 0, 0, 8, 4, 14, 8, 33564672, 14, 23, 1, 33564659, 33564664, 3, 33564665, 33564663, 33564671, 0, 33564671, 3, 33564660, 11, 33564663, 33564666, 13, 33564667, 33564671, 33564669, 18, 1, 33564669, 1, 33564657, 33564664, 33564662, 27, 33564664, 3, 33564671, 33564670, 5, 11, 9, 33564667, 15, 6, 33564672, 22, 33564665, 6, 33564668, 33564648, 33564670, 10, 33564671, 2, 9, 6, 33564665, 33564663, 33564667, 0, 33564659, 5, 33564669, 7, 33564663, 4, 13, 7, 3, 10, 33564665, 33564668, 33564671, 33564664, 33564671, 2, 11, 2, 12, 33564667, 33564666, 33564653, 33564658, 10, 33564661, 33564657, 33564660, 8, 33564661, 7, 5, 33564663, 33564663, 33564672, 33564657, 6, 17, 33564658, 5, 12, 14, 33564666, 33564661, 11, 5, 33564656, 33564661, 33564669, 5, 8, 16, 5, 33564664, 33564661, 33564669, 3, 33564663, 33564657, 4, 1, 0, 6, 33564668, 33564663, 0, 11, 33564668, 33564668, 33564657, 33564662, 11, 12, 33564661, 12, 33564669, 33564670, 33564656, 33564659, 5, 33564671, 33564668, 3, 33564670, 2, 9, 33564664, 33564668, 33564660, 33564671, 33564671, 3, 25, 33564664, 33564658, 33564657, 33564670, 11, 19, 33564661, 3, 4, 1, 0, 33564668, 33564658, 33564662, 14, 33564663, 33564651, 7, 33564668, 33564662, 2, 33564668, 33564672, 33564651, 33564661, 19, 3, 33564659, 33564661, 33564655, 33564672, 2, 33564669, 19, 33564672, 15, 1, 4, 4, 33564656, 11, 0, 4, 6, 13, 33564650, 33564667, 33564663, 3, 17, 33564665, 33564670, 33564663, 33564663, 15, 33564670, 33564657, 5, 8, 33564666, 33564659, 1, 33564656, 33564671, 33564652, 18, 33564666, 33564666, 16, 33564665, 33564658, 33564659, 33564669, 33564665, 33564660, 5, 10, 4, 33564669, 33564666, 1, 7, 33564649, 33564664, 33564670, 33564665, 33564655, 33564668, 11, 12, 10, 5, 21, 9, 5, 1, 11, 33564652, 33564670, 0, 14, 4, 33564667, 13, 33564647, 4, 33564663, 33564660, 33564670, 16, 3, 33564654, 33564668, 6, 33564662, 7, 16, 33564670, 10, 1, 33564671, 33564668, 33564668, 6, 33564660, 33564672, 3, 1, 3, 33564662, 5, 6, 33564657, 33564660, 33564670, 4, 33564669, 3, 9, 1, 33564654, 33564652, 6, 33564669, 11, 11, 33564665, 7, 18, 4, 19, 9, 33564658, 33564655, 33564669, 33564668, 33564672, 0, 1, 3, 33564662, 33564669, 2, 33564670, 22, 33564672, 5, 33564664, 23, 13, 9, 33564667, 3, 33564661, 33564671, 15, 4, 10, 33564671, 11, 33564668, 33564669, 10, 2, 33564667, 6, 33564664, 11, 1, 33564671, 33564668, 7, 8, 33564666, 33564667, 0, 2, 11, 33564667, 13, 2, 33564657, 7, 13, 33564664, 33564670, 0, 33564670, 5, 15, 3, 0, 23, 9, 33564656, 21, 33564665, 33564671, 2, 18, 1, 6, 33564656, 0, 33564672, 33564672, 22, 5, 33564672, 33564660, 9, 3, 13, 12, 33564659, 4, 8, 2, 33564661, 33564671, 33564671, 6, 33564669, 18, 11, 33564659, 33564671, 12, 3, 33564666, 33564664, 1, 33564657, 33564668, 33564668, 33564669, 11, 11, 3, 33564671, 7, 33564664, 33564658, 9, 22, 33564658, 0, 3, 8, 10, 21, 33564665, 16, 8, 33564671, 33564657, 7, 3, 2, 33564658, 33564670, 33564661, 9, 8, 13, 28, 33564668, 0, 10, 33564667, 1, 8, 33564671, 33564662, 33564665, 33564672, 33564665, 8, 33564667, 14, 33, 1, 12, 14, 33564666, 33564668, 3, 33564664, 16, 10, 22, 21, 0, 8, 4, 33564670, 4, 33564672, 15, 0, 33564667, 33564662, 33564667, 0, 10, 4, 3, 33564672, 5, 15, 33564672, 23, 1, 25, 33564664, 33564662, 13, 4, 33564669, 33564663, 22, 33564670, 33564672, 33564658, 33564653, 21, 0, 33564668, 0, 2, 2, 33564659, 33564662, 7, 2, 10, 2, 33564672, 33564650, 0, 33564672, 33564661, 3, 15, 33564661, 33564665, 3, 7, 33564672, 13, 33564649, 8, 4, 33564671, 33564666, 33564665, 33564664, 4, 8, 33564655, 0, 0, 33564659, 33564659, 14, 14, 1, 33564659, 7, 18, 8, 7, 33564664, 10, 33564648, 1, 33564659, 7, 17, 4, 33564672, 9, 33564660, 33564670, 33564669, 33564671, 6, 5, 33564671, 33564664, 6, 33564670, 33564669, 28, 3, 33564660, 3, 13, 6, 9, 33564666, 6, 6, 33564667, 33564668, 33564669, 23, 3, 1, 3, 1, 33564665, 33564662, 33564658, 33564668, 33564665, 33564672, 12, 1, 0, 10, 13, 8, 1, 4, 3, 33564668, 21, 9, 33564663, 33564665, 33564670, 33564665, 33564672, 19, 33564670, 8, 6, 1, 7, 5, 33564671, 33564665, 11, 33564662, 6, 33564665, 33564658, 17, 3, 6, 33564659, 12, 1, 33564655, 33564671, 33564656, 33564663, 33564672, 33564672, 16, 33564664, 30, 33564669, 33564665, 8, 33564667, 33564662, 0, 16, 3, 6, 15, 1, 16, 7, 4, 4, 33564654, 2, 33564668, 12, 1, 2, 33564662, 33564665, 4, 33564656, 7, 33564670, 5, 33564666, 33564668, 33564666, 33564672, 10, 13, 33564670, 33564668, 33564649, 33564662, 6, 12, 33564666, 14, 2, 33564671, 21, 1, 3, 13, 33564671, 3, 33564656, 18, 33564666, 33564649, 20, 5, 6, 33564667, 9, 33564661, 0, 7, 4, 33564663, 8, 33564664, 2, 1, 33564663, 33564662, 1, 0, 33564672, 4, 33564672, 1, 12, 33564658, 1, 4, 12, 11, 33564666, 33564653, 33564657, 33564670, 33564666, 33564669, 7, 11, 15, 33564670, 33564659, 33564672, 1, 33564670, 10, 33564663, 1, 33564660, 12, 33564668, 3, 33564661, 33564665, 33564665, 33564665, 33564669, 8, 3, 33564670, 33564669, 33564665, 10, 33564662, 14, 2, 2, 7, 5, 33564663, 9, 33564657, 33564670, 33564653, 33564670, 14, 3, 4, 18, 8, 33564669, 33564662, 33564671, 33564654, 33564669, 2, 33564665, 33564671, 10, 4, 10, 15, 33564659, 7, 9, 33564659, 3, 33564669, 13, 9, 16, 4, 33564669, 4, 8, 33564672, 29, 1, 8, 8, 33564666, 33564672, 33564663, 33564665, 33564670, 33564659, 8, 14, 33564667, 33564663, 1, 6, 33564655, 33564669, 33564652, 33564650, 13, 33564672, 1, 7, 15, 7, 19, 3, 18, 33564668, 10, 9, 6, 0, 3, 4, 33564653, 33564662, 0, 33564656, 33564662, 10, 33564670, 7, 5, 33564668, 8, 8, 12, 13, 33564669, 1, 33564652, 5, 33564669, 1, 33564669, 1, 3, 15, 33564664, 4, 33564666, 1, 33564655, 33564670, 33564667, 33564650, 33564671, 33564663, 33564654, 33564670, 5, 33564668, 33564671, 33564663, 33564659, 7, 8, 33564664, 33564663, 6, 33564671, 0, 4, 33564672, 33564669, 9, 33564667, 33564662, 33564661, 33564665]
        ab = [2762981, 23255198, 33312807, 11629435, 17494173, 14327448, 10197560, 3115451, 11005143, 3728514, 21540342, 3018656, 22400238, 1677330, 14267360, 4264340, 22305818, 4640993, 20139519, 9328020, 19557297, 17534910, 15262650, 21462026, 22165360, 6498732, 18211515, 12145632, 6474518, 25223768, 17055037, 3060285, 19228100, 12948903, 18488092, 9919237, 29800204, 8577081, 32694311, 20192772, 4106688, 4795909, 31996401, 12149231, 3634472, 2790860, 16531047, 15175237, 7072318, 11026647, 31980185, 6240121, 1192854, 19037518, 19647957, 13746329, 25527035, 2219878, 8091612, 8603067, 12936334, 249373, 28794294, 26719037, 2655363, 3981206, 17857761, 28422599, 13658990, 19980264, 17115765, 19830714, 22898047, 14643512, 31902994, 1006560, 257043, 23487103, 17384477, 24798341, 17297168, 23772195, 27923747, 1460981, 14426276, 13516173, 18847886, 22215633, 28311522, 10749332, 28258882, 4220732, 22807137, 12175493, 32622672, 9577073, 25105467, 33250784, 29163259, 8059452, 28784984, 31284549, 17602643, 32821052, 22286338, 29813629, 8400882, 20762321, 23630839, 33128038, 17111084, 20742259, 22452291, 4710976, 7428912, 18066088, 28001465, 29805063, 5720890, 30101089, 9664941, 15391226, 24717486, 13886158, 20865304, 32762715, 17093701, 21228242, 1804881, 27169946, 15168031, 23674906, 3835734, 31510513, 388009, 14199452, 26361332, 30628210, 19489856, 77034, 1602453, 754704, 12091474, 17292009, 28861042, 12833657, 225444, 16359963, 30108001, 24862657, 30217172, 8412933, 20964397, 22456550, 29184018, 29582546, 17930000, 15754990, 15165533, 26347624, 25034299, 29787286, 4124102, 28800267, 14391300, 23920444, 1318164, 14393440, 495356, 9143198, 21556786, 26092021, 14861492, 18851735, 11428095, 28579279, 33116132, 7588689, 9675901, 10634153, 25546892, 30567188, 23640050, 16630517, 28407861, 26326905, 6224484, 22602146, 19743214, 7870260, 29084937, 6110191, 8324367, 16943348, 19753784, 5823734, 5289478, 20861489, 2734170, 13004993, 28383093, 25688334, 2208198, 6305533, 16299557, 24472147, 31946333, 13010586, 23089269, 12941072, 33401617, 29339482, 11988071, 17672592, 18093192, 21850208, 29688337, 8513935, 11737367, 2723172, 4689844, 11627270, 30057538, 20429488, 5483589, 32781870, 3819831, 11252955, 13106182, 7479028, 33484765, 26154369, 12184491, 11865303, 31308581, 20781612, 23573915, 22352294, 10631702, 25367074, 11258828, 2630529, 18685300, 14531926, 10374032, 12873028, 27385836, 13307743, 4450498, 22811243, 1360842, 23864378, 28557101, 26696376, 7356684, 12813653, 9042080, 3089161, 17321371, 24406678, 1447255, 6868202, 25127651, 1913102, 18346321, 2028469, 746315, 27473982, 16717450, 4285094, 31353675, 15230749, 6629281, 4820727, 18309579, 11688761, 10066888, 5627475, 24670794, 25961327, 7004340, 18225087, 26179036, 7456954, 31164139, 32935517, 11926243, 24811549, 4550811, 4560448, 27435771, 25181493, 3023035, 2910319, 1928464, 4638308, 12321541, 18604837, 9568672, 20126833, 6621670, 17714777, 8907782, 7680671, 4150525, 28458948, 33056280, 27502489, 24839901, 32522262, 6610581, 1087484, 2857337, 25603807, 12061503, 15721900, 28780962, 15689789, 32523588, 24067644, 11754980, 23162200, 7639236, 17302980, 16975806, 29364693, 5055257, 19524420, 1954460, 11641893, 15853106, 27570659, 2749446, 15256055, 32432316, 4068536, 2475944, 11168020, 16303522, 33371549, 2617687, 27250407, 10814918, 20964763, 30372936, 20048614, 5365503, 25219259, 29752360, 1336100, 28940973, 4008698, 9394239, 4856374, 2362096, 28155293, 15084841, 2378806, 29829229, 4263801, 23112521, 22406415, 20107347, 29199683, 30061067, 13863133, 7920452, 26183401, 5583344, 33551577, 23238582, 17230625, 10378581, 20539217, 11375608, 32235537, 11955219, 32208203, 27085401, 16050085, 33428879, 10314275, 31329151, 25062521, 22379444, 4572407, 10122313, 24598935, 31057206, 11659818, 21577564, 10741699, 10846328, 32084246, 3406668, 3346765, 24582940, 2491312, 1743520, 17383525, 20186184, 11463118, 21362586, 17980125, 9467764, 33086276, 18778961, 13452092, 3987010, 1551928, 28289122, 9424702, 19479050, 30452621, 29938643, 19994326, 9394260, 6342499, 19405765, 7775928, 25813636, 30755361, 8074242, 6417340, 3560722, 22078916, 21114008, 29350174, 29258914, 8977399, 16594723, 23758583, 11179344, 8100484, 18419033, 8920828, 33114449, 19625063, 14070567, 31915318, 24712591, 13092503, 5317943, 28665110, 4070541, 6365689, 13676183, 14949582, 5733059, 32698693, 28185687, 20652753, 11450694, 25124611, 25526100, 6917636, 29416964, 23602906, 5510272, 10433284, 22040944, 17169288, 14944301, 1162991, 23540602, 15103196, 32747818, 15678757, 32110929, 3592795, 18735912, 26432999, 529693, 13049646, 9081825, 5039277, 27688361, 311444, 8454057, 10980945, 24526756, 6326353, 28187559, 13501061, 23608545, 17868853, 26498417, 16678205, 1379326, 11438684, 5512762, 2994370, 13962031, 26414353, 10470196, 32872544, 9508967, 27018536, 12001657, 19000018, 2776890, 3169056, 6250244, 27148561, 29044940, 5183385, 22107143, 9173324, 1842455, 1371080, 17216516, 18917920, 6806973, 25608104, 16199009, 9975628, 6362099, 9946984, 20966888, 30209024, 22565440, 9960084, 780519, 27077443, 28288965, 29373361, 27506994, 1132237, 11947554, 18253483, 21728840, 32436892, 1512356, 19441434, 30986082, 32815322, 23514766, 27190243, 16386831, 23691743, 23979822, 14877759, 12837922, 15274910, 14409710, 20524975, 9602370, 21752564, 5462928, 20082042, 14148984, 12343052, 5409030, 19102074, 15181304, 1384381, 29378052, 5076632, 1419191, 14611321, 2235956, 29661909, 15209955, 952013, 17993866, 30801195, 12262557, 32340960, 6987264, 29716239, 19928326, 11690367, 13561452, 27105919, 16436830, 826955, 25727543, 9727549, 31660318, 19129297, 8701403, 17428500, 29009579, 32878232, 11593085, 32381272, 18129374, 19288814, 29272217, 535892, 8978240, 4230148, 25977940, 18539399, 19624818, 15803066, 31339208, 1693997, 10486146, 18519473, 4296203, 14109957, 10542812, 23065148, 6824727, 13776295, 11829256, 29219262, 8165775, 14520236, 19331589, 26047807, 28015386, 15183877, 1887733, 22599555, 1967812, 16505279, 31094473, 1702707, 12889080, 28267956, 23776305, 18375159, 14045313, 27106829, 21782836, 26131594, 12041736, 4444954, 1807347, 16986248, 17714628, 23961287, 31884583, 10739236, 16718423, 17120118, 15365941, 18709023, 1198556, 1589109, 7650864, 18912836, 2838108, 5364819, 30740335, 28872385, 14931089, 8015774, 26539437, 30595247, 33157426, 33558709, 26724146, 7952397, 27624256, 24607048, 30368827, 8305885, 1397265, 7916640, 16022311, 160932, 27090385, 6577321, 31178390, 33115791, 13286629, 11195588, 5842670, 28296473, 11519354, 33050112, 8066070, 12738644, 25657366, 26490903, 13145174, 29143476, 29391410, 5456698, 2911334, 21169443, 16228503, 8393444, 1154323, 5823324, 225265, 4956510, 25916759, 24004171, 30344817, 4580654, 16258535, 6206073, 623351, 18526436, 25148476, 29830846, 27272675, 3158593, 13425880, 15017387, 164325, 27001093, 16956772, 218024, 29878053, 23646546, 25124783, 20044442, 31439451, 14550306, 19295869, 3759327, 11110345, 18488071, 5796723, 27295694, 2114605, 4799508, 30735907, 3286220, 213391, 25069744, 1809425, 17599387, 1545660, 28565003, 10765656, 9691346, 20443361, 461617, 11804250, 14730012, 31364857, 18642102, 22894260, 21875699, 28787666, 31401288, 31270303, 21118666, 19266562, 26125731, 15026443, 1225184, 31464834, 11981329, 6067534, 2710016, 13165540, 14756638, 6416284, 25935660, 32798086, 18368511, 26691476, 8159402, 17847184, 5580115, 2225952, 14184664, 10745839, 6941279, 3890118, 22248283, 8704764, 31768428, 25382106, 28961072, 1315182, 26407090, 27440340, 20044401, 22966928, 31750620, 30752551, 22828267, 15369310, 27349470, 21377252, 12386108, 11682258, 5636921, 259258, 12227783, 4352939, 5542596, 18051116, 1268500, 23816136, 14507869, 22024804, 30871775, 23935207, 38784, 24358612, 26561324, 532498, 16603313, 2660042, 5873092, 28976937, 25968770, 4951801, 15117047, 18428471, 17025522, 26744475, 11450296, 6639079, 638125, 2547340, 821843, 29071863, 7901106, 3686501, 26747471, 15558491, 5960538, 2730109, 5424111, 5562744, 13792949, 10347393, 2810138, 15197846, 23980773, 15097601, 18372372, 26141441, 16582730, 5225066, 9540429, 28410964, 4329164, 22083238, 28648584, 4350706, 29271311, 26788324, 13119534, 28644741, 7768942, 13530949, 6702601, 12213106, 17566382, 14327324, 23642202, 5708165, 31299469, 7461067, 4868977, 32389167, 23669012, 24445271, 32428734, 9927840, 23103451, 3368779, 12928109, 11456165, 13135747, 20527908, 18688944, 376053, 24627067, 11332381, 19252975, 11274804, 17530689, 32036412, 29046392, 12966917, 14221053, 11333359, 4958457, 7807052, 9858702, 25325630, 27539791, 12789338, 10216878, 19871032, 22861001, 18935690, 22808317, 2421819, 10082986, 26314376, 13575671, 17768064, 19062816, 23588646, 29043731, 30143761, 12673363, 20429747, 21000648, 31807970, 11785762, 16991149, 32799160, 33230144, 18640101, 23142494, 13666841, 8674790, 29262930, 8511503, 9660384, 32662670, 22635204, 31400873, 16011591, 4083815, 8665763, 22438786, 14550798, 18882787, 20614045, 31261098, 3750160, 504106, 22349390, 20011274, 4102239, 31439561, 17182469, 31238704, 1366522, 28390667, 13226477, 28441537, 26502096, 17209267, 13712273, 13935583, 6127784, 32251665, 7219478, 15123881, 25837004, 25629381, 24605850, 13896002, 9167122, 878639, 22931531, 21360075, 18770798, 12300453, 21208043, 4839696, 32789433, 28474755, 19058917, 32476010, 7735608, 19421467, 5785481, 22684037, 11689402, 18223527, 26470876, 8176798, 25060782, 30891256, 22583571, 23661351, 114433, 13927797, 33301154, 11906920, 20234731, 21817665, 25225549, 12082432, 8367722, 2711604, 18987834, 16379856, 19196127, 20435459, 32306423, 29967422, 28549360, 1129313, 5760843, 26512750, 23772201, 16776527, 3904146, 14307919, 21021804, 10560568, 15328536, 18229920, 29397703, 8123227, 18668762, 18189564, 25984309, 27451846, 26602910, 20033718, 7257147, 20536842, 33524650, 9812984, 3794371, 12254957, 8986568, 30943033, 27029245, 13985829, 25592429, 9927020, 20712851, 19076370, 23954852, 25821448, 31097263, 31700046, 33441620, 9820942, 12334289, 740034, 8214107, 1449666, 6764765, 29321641, 15711544, 24721196, 32324694, 7067033, 519181, 444877, 2398002, 18869311, 1701294, 12521006, 25478335, 24325877, 19020844, 29742043, 10308651, 13820720, 6870355, 20448233, 5710662, 23731429, 8651708, 1626872, 5470715, 31517289, 15243787, 11319371, 24529320, 9141256, 24009505, 14108762, 20958969, 16875143, 5017343, 22722593, 6838819, 17926969, 6984210, 30951699, 23364353, 3893078, 17578690, 365242, 6067865, 21901230, 3450646, 11479645, 20239257, 27142702, 33426323, 2182376, 13295299, 12919159, 9117186, 17810592, 17514811, 345489, 24396013, 31327921, 5180648, 20281493, 21098921, 1718801, 28728379, 25618864, 9896184, 4098005, 16127977, 32495688, 17906342, 25047908, 31718830, 19501784, 21388061, 14351479, 18305607, 19948061, 3135714, 26550563, 33087475, 24085542, 3967503, 1281187, 13529886, 15650106, 20524954, 25293887, 16647641, 2582900, 13987089, 25470494, 22052242, 11392113, 25019480, 20253050, 17729052, 21985605, 30524211, 24112164, 24531583, 1393604, 10461316, 11079637, 6989063, 10460544, 22246864, 10734873, 30112128, 23301734, 25157688, 25679987, 16540524, 17887638, 8852312, 13923240, 8545934, 16861976, 27197611, 8972397, 1193881, 7229978, 20285954, 25063309, 6346873, 22904960, 30326595, 11743278, 16993806, 2955237, 18970054, 21989676, 6827930, 18635224, 13098320, 24483273, 597619, 28543626, 32316239, 18499250, 9743305, 25155354, 3343169, 14050324, 10112859, 29926353, 28149344, 6316586, 7122574, 7136457, 33095040, 27415962, 17773809, 15493602, 8402465, 10873692, 2497555, 23628631, 30418797, 13578976, 25329879, 6960232, 13322869, 22644091, 22913746, 27799933, 6835621, 10451784, 22263874, 6240392, 6165586, 4222591, 24821969, 26118615, 15670620, 25385080, 13419073, 7157818, 23937699, 32747808, 25183736, 16536902, 936490, 17769729, 22498135, 972071, 15441927, 8087892, 7789779, 16270787, 4844833, 30629956, 14395123, 3785193, 33281913, 22666986, 20083478, 21345114, 25127824, 28259256, 2426800, 25939213, 17097696, 26356920, 29899334, 14097303, 29569735, 24579190, 1452166, 10577186, 21012327, 19176646, 15502547, 10684240, 1383538, 7949976, 3886690, 29109670, 26077868, 10090572, 19192945, 6173814, 30365764, 3173910, 21592843, 9235528, 3641163, 9711181, 1855587, 434278, 16927499, 32714667, 11378451, 3708117, 9709244, 14932052, 30597069, 7815812, 23952100, 24930562, 23500935, 22436225, 15104487, 10666006, 18205453, 19758771, 14499831, 23914353, 25678759, 31267376, 12210675, 26158235, 2765735, 11567576, 5596259, 8157827, 19419576, 29717484, 14103852, 15974625, 26837977, 10802535, 26043119, 3351295, 28201067, 18060210, 1463815, 14157464, 28238951, 21832226, 807939, 24695801, 22002592, 19573654, 6017927, 18215128, 12240108, 30199241, 20240796, 14861766, 3187150, 17269444, 18096360, 5028204, 3296489, 8268725, 25052166, 4977786, 22029172, 24752365, 19786066, 17960348, 1943920, 14374944, 12362219, 29197304, 11178974, 25393202, 18525403, 18694166, 15053813, 26987791, 29823847, 29571586, 18056001, 6690753, 8090370, 27656913, 11507963, 16199555, 23663121, 32460133, 7529977, 28842258, 22040320, 17554802, 5433279, 11992730, 21111816, 17258161, 17255325, 1405740, 5847082, 6278775, 2596373, 13346013, 2821147, 22751072, 26319870, 18078819, 10665292, 7609505, 12974118, 29322040, 12687951, 31649485, 30210762, 18822792, 17205565, 11494728, 5788021, 29684872, 14722542, 15609250, 15151043, 7025170, 28396834, 7383779, 7028663, 4655922, 31355691, 4964087, 8629753, 10168782, 29541356, 29379704, 11074591, 32848582, 30143123, 12196040, 16340465, 29859364, 17277383, 12417484, 10758809, 3418677, 5738092, 5958918, 26067637, 29886316, 851027, 28765064, 21893776, 26265903, 30606241, 16783802, 2139951, 33153875, 14318387, 13849999, 9727188, 28119191, 21310712, 6613752, 26492153, 12920630, 8057072, 8928301, 31418049, 32768180, 26890305, 15664849, 6307172, 7782404, 8436147, 26556431, 28792872, 27838247, 21512593, 12798982, 25913863, 28640726, 6484519, 7184064, 23095732, 25631049, 28085477, 16657974, 14703963, 14714418, 21766433, 4896715, 15564550, 32867747, 15113925, 16344314, 5498086, 10210112, 33010821, 22652872, 30955594, 4354490, 7140450, 24512464, 19717919, 14240716, 21751074, 32566655, 32474956, 25844820, 8338566, 25919037, 27362175, 5600000, 411887, 10985852, 30598054, 21714288, 26172911, 1269422, 25892774, 12643281, 32578049, 29215457, 3803419, 23732389, 2633176, 11883923, 21402913, 3675485, 8285215, 398797, 10409141, 31827449, 6959417, 20421244, 27363808, 19333515, 6033692, 5629639, 30860870, 21206452, 1253994, 7262405, 15199283, 21841635, 4736020, 27236304, 32404447, 8082847, 18818591, 32637859, 10407310, 8675281, 22358825, 21818155, 9088577, 9286062, 1866622, 26751002, 17962453, 23451327, 5910947, 8126153, 22674731, 22984218, 25230850, 3193652, 30388702, 2712022, 14894987, 30970577, 32315501, 17090688, 25039466, 20283555, 6709341, 18769528, 5674207, 2321428, 16909584, 21438069, 20395696]
        
        start_time = time.time()
        c = poly_mul(a, b)
        end_time = time.time()

        print("----------", end_time - start_time, "s. ----------")

        assert(c == ab)        

if __name__ == '__main__':    
    unittest.main()